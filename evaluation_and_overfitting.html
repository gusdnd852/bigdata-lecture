<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" type="image/x-icon" href="/bigdata-lecture/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>모델 평가방법 및 오버피팅 | TensorFlow로 시작하는 머신러닝 &amp; 딥러닝</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="모델 평가방법 및 오버피팅" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="머신러닝 모델을 평가하는 방법과 오버피팅에 대해 알아봅시다." />
<meta property="og:description" content="머신러닝 모델을 평가하는 방법과 오버피팅에 대해 알아봅시다." />
<link rel="canonical" href="https://gusdnd852.github.io/bigdata-lecture/evaluation_and_overfitting" />
<meta property="og:url" content="https://gusdnd852.github.io/bigdata-lecture/evaluation_and_overfitting" />
<meta property="og:site_name" content="TensorFlow로 시작하는 머신러닝 &amp; 딥러닝" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-25T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://gusdnd852.github.io/bigdata-lecture/evaluation_and_overfitting","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://gusdnd852.github.io/bigdata-lecture/evaluation_and_overfitting"},"headline":"모델 평가방법 및 오버피팅","dateModified":"2020-07-25T00:00:00-05:00","datePublished":"2020-07-25T00:00:00-05:00","description":"머신러닝 모델을 평가하는 방법과 오버피팅에 대해 알아봅시다.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
  <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css">
    <link rel="stylesheet" href="/bigdata-lecture/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://gusdnd852.github.io/bigdata-lecture/feed.xml" title="TensorFlow로 시작하는 머신러닝 & 딥러닝" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
          ]}
        );
      });
    </script>
  

  <script>
  function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
  }
  window.onload = wrap_img;
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function(){
      // add link icon to anchor tags
      var elem = document.querySelectorAll(".anchor-link")
      elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
      // remove paragraph tags in rendered toc (happens from notebooks)
      var toctags = document.querySelectorAll(".toc-entry")
      toctags.forEach(e => (e.firstElementChild.innerText = e.firstElementChild.innerText.replace('¶', '')))
    });
  </script>
</head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>

     @media screen and (max-width : 511px) {
         body { 
		font-size: 0.84rem; 
	}pre, code, blockquote {
		font-size: 0.84rem !important;
	}
	.katex, .mord {
		font: normal 1.02em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.90em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 0.9rem !important;
	}
	.contents-left{
		display: none !important;
	}
	.contents-right, .contents-left {
    		display: block;
    		text-align: center;
		margin-left: 0px !important;
    		margin-right: 0px !important;
    		list-style: none;
    	}
	.mobile_hide{
		display: none;
	}
	.contents-right > li {
    		display: inline-block;
    		margin: 3px;
    		word-break: keep-all;
	}
     }
 

     @media screen and (min-width : 512px) and (max-width : 767px) {
         body { 
		font-size: 0.92rem; 
	}pre, code, blockquote {
		font-size: 0.92rem !important;
	}
	.katex, .mord {
		font: normal 1.04em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.92em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 1.0rem !important;
	}
	.contents-left{
		display: none !important;
	}
	.contents-right, .contents-left {
    		display: block;
    		text-align: center;
		margin-left: 0px !important;
    		margin-right: 0px !important;
    		list-style: none;
    	}    
	.mobile_hide{
		display: none !important;
	}
	.contents-right > li {
    		display: inline-block;
    		margin: 3px;
    		word-break: keep-all;
	}
     }
 
     @media screen and (min-width : 768px) and (max-width : 1024px) {
         body {
		 font-size: 1.0rem; 
	}pre, code, blockquote {
		font-size: 1.0rem !important;
	}
	.katex, .mord {
		font: normal 1.05em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.93em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 1.1rem !important;
	}
	.contents-right, .contents-left {
		display: inline-block;
    		vertical-align: top;
    		text-align: left;
		list-style: none;
    	}  
	.contents-left{
		margin-left: 20px !important;
    		margin-right: 3.0rem;
	}
	.mobile_hide{
		display: block !important;
	}
     }

     @media screen and (min-width : 1025px) {
         body { 
		font-size: 1.08rem; 
	}pre, code, blockquote {
		font-size: 1.08rem !important;
	}
     	.katex, .mord {
		font: normal 1.06em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.94em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 1.2rem !important;
	}
	.contents-right, .contents-left {
    		display: inline-block;
    		vertical-align: top;
    		text-align: left;
		list-style: none;
    	}
	.contents-right > h2, .contents-left > h2 {
    		margin-botton: 2px
	}  
	.contents-left{
    		margin-left: 0 !important;
    		margin-right: 3.0rem;
	}
	.mobile_hide{
		display: block !important;
	}
     }

    </style>
  <body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" style="font-size:1.2rem;" href="/bigdata-lecture/">TensorFlow로 시작하는 머신러닝 &amp; 딥러닝 </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/bigdata-lecture/lecture">Lecture</a><a class="page-link" href="/bigdata-lecture/orientation">Orientation</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content" style="flex: none;" >
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h3 class="post-title p-name" itemprop="name headline">01. 모델 평가방법 및 오버피팅</h3><p class="page-description">머신러닝 모델을 평가하는 방법과 오버피팅에 대해 알아봅시다.</p
      <i class="fas fa-tags category-tags-icon"></i><p class="category-tags"> 
      
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
	
	<div class="px-1">
    <a href="https://colab.research.google.com/github/gusdnd852/bigdata-lecture/blob/master/_notebooks/05_01_모델_평가방법과_오버피팅.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/bigdata-lecture/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
	
	<div class="px-1">
<a href="https://github.com/gusdnd852/bigdata-lecture/tree/master/_notebooks/05_01_모델_평가방법과_오버피팅.ipynb" role="button">
    <img class="notebook-badge-image" src="https://img.shields.io/static/v1?label=&message=View%20On%20GitHub&color=586069&logo=github&labelColor=2f363d">
</a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#1.-모델-평가방법과-오버피팅이란?">1. 모델 평가방법과 오버피팅이란? </a></li>
<li class="toc-entry toc-h3"><a href="#2.-Accuracy">2. Accuracy </a></li>
<li class="toc-entry toc-h3"><a href="#3.-Precision">3. Precision </a></li>
<li class="toc-entry toc-h3"><a href="#4.-Recall">4. Recall </a></li>
<li class="toc-entry toc-h3"><a href="#5.-F1-Score">5. F1 Score </a></li>
<li class="toc-entry toc-h3"><a href="#6.-sklearn에서-사용하는-방법">6. sklearn에서 사용하는 방법 </a></li>
<li class="toc-entry toc-h3"><a href="#7.-Confusion-Matrix-(혼잡-행렬)">7. Confusion Matrix (혼잡 행렬) </a></li>
<li class="toc-entry toc-h3"><a href="#7.-Overfitting">7. Overfitting </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/05_01_모델_평가방법과_오버피팅.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br><br></p>
<h3 id="1.-모델-평가방법과-오버피팅이란?">
<a class="anchor" href="#1.-%EB%AA%A8%EB%8D%B8-%ED%8F%89%EA%B0%80%EB%B0%A9%EB%B2%95%EA%B3%BC-%EC%98%A4%EB%B2%84%ED%94%BC%ED%8C%85%EC%9D%B4%EB%9E%80?" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. 모델 평가방법과 오버피팅이란?<a class="anchor-link" href="#1.-%EB%AA%A8%EB%8D%B8-%ED%8F%89%EA%B0%80%EB%B0%A9%EB%B2%95%EA%B3%BC-%EC%98%A4%EB%B2%84%ED%94%BC%ED%8C%85%EC%9D%B4%EB%9E%80?"> </a>
</h3>
<p><img src="https://github.com/gusdnd852/bigdata-lecture/blob/master/_notebooks/img/Day5/bao_0.png" alt=""></p>
<p>지난 시간까지 우리는 다양한 모델에 대해 학습하였고 모델의 결과물에 대해 Accuracy를 사용하여 평가하였습니다. 하지만 정말 모든 경우에서 Accuracy를 사용하는 것이 정답일까요?<br><br></p>
<p>이번 시간에는 Accuracy를 비롯한 Precision, Recall, F1 Score등의 모델 평가방법에 대해 알아보고 오버피팅이 무엇인지에 대해 학습하도록 하겠습니다.<br><br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.-Accuracy">
<a class="anchor" href="#2.-Accuracy" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Accuracy<a class="anchor-link" href="#2.-Accuracy"> </a>
</h3>
<p>Accuracy는 모델이 예측하여 맞은 개수를 전체 개수로 나눈 값입니다. 예를 들어, 양성과 음성이 각각 500명인 질병 환자에 대해 감염 여부를 예측하는 모델을 실행하였을때 아래와 같은 결과가 나왔다고 가정해봅시다.</p>
<ul>
<li>예측 #1</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">case1_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'음성(예측)'</span><span class="p">,</span> <span class="s1">'양성(예측)'</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">'음성(실제)'</span><span class="p">,</span> <span class="s1">'양성(실제)'</span><span class="p">],</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">390</span><span class="p">,</span> <span class="mi">110</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">490</span><span class="p">]]</span>
<span class="p">)</span>

<span class="n">case1_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>음성(예측)</th>
      <th>양성(예측)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>음성(실제)</th>
      <td>390</td>
      <td>110</td>
    </tr>
    <tr>
      <th>양성(실제)</th>
      <td>10</td>
      <td>490</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>실제로는 음성 500명, 양성 500명이지만 모델은 양성 400명, 음성 600명으로 예측하였고, Accuracy는 (390+490)/1000 = 0.88이 됩니다. 잘 평가된 것 같습니다. 하지만 다음과 같은 경우는 어떨까요?
<br><br></p>
<ul>
<li>예측 #2</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">case2_df</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'음성(예측)'</span><span class="p">,</span> <span class="s1">'양성(예측)'</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">'음성(실제)'</span><span class="p">,</span> <span class="s1">'양성(실제)'</span><span class="p">],</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">900</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="p">)</span>

<span class="n">case2_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>음성(예측)</th>
      <th>양성(예측)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>음성(실제)</th>
      <td>900</td>
      <td>0</td>
    </tr>
    <tr>
      <th>양성(실제)</th>
      <td>100</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>동일하게 1000명을 대상으로 예측을 진행했지만, 이번에는 실제 양성의 수가 100명, 음성의 수가 900명입니다. 모델의 예측 결과는 1000명 모두 음성으로 판단하였기 때문에 Accuracy는 900/1000 = 0.90이 됩니다. 이 모델은 정말 병을 검출할 수 있는 능력이 있는 것일까요? <br><br></p>
<p>두번째 모델은 전체 1000명의 환자 중에 실제로 100명은 양성반응을 보이는데, 단 한명도 잡아내지 못했지만 정확도는 0.9를 기록했습니다. 심지어 두 번째 예측이 첫 번째 예측보다 0.02 높은 Accuracy를 기록했으므로 Accuracy에 기반하여 판단한다면 두 번째 모델이 더 좋은 모델이라고 판단할 수 있겠습니다. <br><br></p>
<p>하지만, 두 번째 예측은 양성을 단 한명도 예측해내지 못했습니다. 양성을 단 한명도 예측하지 못하는 모델이 Accuracy가 높다는 것만을 이유로 더 좋다고 판단하는 것이 옳은 선택일까요? 이처럼 <strong>불균형한(Imbalanced) 데이터에서는 Accuracy를 사용할 경우 잘못된 성능 예측 결과를 가져올 수 있음</strong>을 꼭 기억해야 합니다. 따라서 분류문제의 경우 Accuracy의 문제를 해결하기 위해 Precision, Recall과 이를 이용한 F1 Score 등을 주로 사용하는 편입니다. 이에 대해 알아봅시다. <br><br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.-Precision">
<a class="anchor" href="#3.-Precision" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Precision<a class="anchor-link" href="#3.-Precision"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Precision은 모델이 True라고 분류한 항목에서 실제 True인 것의 비율로, <strong>모델의 예측 관점</strong>에서 보는 평가 방법입니다.</p>
<p><img src="https://github.com/gusdnd852/bigdata-lecture/blob/master/_notebooks/img/Day5/precision.png" alt=""></p>
<p>두 번째 모델을 이용하여 Precision을 계산해보도록 하겠습니다. 모델이 양성이라고 분류한 항목의 합은 0입니다. 그러므로 Precision(양성)=0입니다. 모델이 음성이라고 분류한 항목의 합은 1000이고, 실제 음성은 900입니다. 그러므로 Precision(음성)=900/(900+100) = 0.90입니다. 즉, <strong>양성이라고 예측한 것은 0%이고, 음성이라고 예측한 것은 90%로 맞았다고 이해하시면 그 것이 Precision의 개념</strong>입니다.<br><br></p>
<p>이제 두 Presicion의 평균을 구하면 두 번째 모델의 Presicion을 알아낼 수 있습니다. 모든 항목의 Presicion을 더하고 항목의 개수만큼 나눠주면 됩니다. 두 번째 모델의 Precision은 (0 + 0.9) / 2 = 0.45입니다. 실제로 이 모델의 성능은 이정도로 형편없다고 봐야합니다.<br><br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.-Recall">
<a class="anchor" href="#4.-Recall" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. Recall<a class="anchor-link" href="#4.-Recall"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Recall은 실제 True인 항목에서 모델이 True라고 예측한 것의 비율로, <strong>데이터 관점</strong>에서 보는 평가 방법입니다.</p>
<p><img src="https://github.com/gusdnd852/bigdata-lecture/blob/master/_notebooks/img/Day5/recall.png" alt=""></p>
<p>마찬가지로 두 번째 모델을 이용하여 Recall을 계산해 보겠습니다. 실제 양성인 항목에서 모델이 양성으로 예측한 값은 0, 음성으로 예측한 값은 100 입니다. 그러므로 Recall(양성) = 0/100 = 0입니다. 실제 음성인 항목에서 모델이 음성으로 예측한 값은 900, 양성으로 예측한 값은 0 입니다. 그러므로 Recall(Neg) = 900/900 = 1입니다. 즉, <strong>실제로 음성인 데이터는 다 맞췄지만, 실제로 양성인 데이터는 하나도 못 맞춘 것이라고 생각하시면 그게 Recall의 개념</strong>입니다. <br><br></p>
<p>두 Recall의 평균을 구하면 두 번째 모델의 Recall을 알아낼 수 있습니다. Presicion과 마찬가지로 모든 Recall을 더하고 항목의 개수로 나눠주면 됩니다. 두 번째 모델의 Recall은 (0 + 1) / 2 = 0.5입니다.<br><br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.-F1-Score">
<a class="anchor" href="#5.-F1-Score" aria-hidden="true"><span class="octicon octicon-link"></span></a>5. F1 Score<a class="anchor-link" href="#5.-F1-Score"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>앞서 구한 Presicion과 Recall을 이용하여 F1 Score를 계산할 수 있습니다. F1 Score를 구하는 식은 다음과 같습니다.</p>
<p><br>

$$2 \times \frac{Presicion \times Recall}{Presicion + Recall}$$

<br></p>
<p>이를 이용하여 두 번째 모델의 F1 Score를 계산하면 2 <em> (0.45 </em> 0.5) / (0.45 + 0.5) = 0.473입니다.</p>
<p><img src="https://github.com/gusdnd852/bigdata-lecture/blob/master/_notebooks/img/Day5/evaluation_result.png" alt=""></p>
<p>두 번째 모델의 평가가 끝났습니다. Accuracy는 0.90이 나왔지만, F1 Score는 0.473이 나왔습니다. 이 모델의 Accuracy만 믿고 사용했다면 부정확한 예측를 대량으로 만들어버리는 좋지 못한 결과를 초래하였을 겁니다. 이를 방지하기 위해서는 Accuracy 이외에도 Precision, Recall, F1 Score를 이용한 평가를 진행하여 모델의 성능을 정확하게 알아내야 합니다. <br><br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.-sklearn에서-사용하는-방법">
<a class="anchor" href="#6.-sklearn%EC%97%90%EC%84%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>6. sklearn에서 사용하는 방법<a class="anchor-link" href="#6.-sklearn%EC%97%90%EC%84%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95"> </a>
</h3>
<p>저는 이미 이전 코드들에서 이러한 평가 기법을 사용해왔지만 제가 여러분에게 설명드리지 않았습니다. 정확도의 경우에는 <code>from sklearn.metrics import accuracy_score</code>로 계산할 수 있고, 나머지 요소의 경우 <code>from sklearn.metrics import XXXX_score</code>와 같이 import 할 수 있습니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">recall_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>

<span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">predict</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'accuracy : '</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">predict</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'precision : '</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">predict</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'macro'</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'recall : '</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">predict</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'macro'</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'f1_score : '</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">predict</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'macro'</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>accuracy :  0.7368421052631579
precision :  0.7444444444444445
recall :  0.5833333333333334
f1_score :  0.6153846153846153
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>이렇게 평가하면 평가하는 코드가 너무 길어지게 됩니다. 따라서 저는 이를 아주 간단하게 표현하는 <code>from sklearn.metrics import classification_report</code>를 자주 사용합니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>

<span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">predict</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">predict</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

           0       0.73      1.00      0.85        11
           1       0.50      0.25      0.33         4
           2       1.00      0.50      0.67         4

    accuracy                           0.74        19
   macro avg       0.74      0.58      0.62        19
weighted avg       0.74      0.74      0.70        19

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>위를 보시면 accuracy, macro avg, weighted avg가 있는데, accuracy는 정확도이고, macro avg는 제가 위에서 설명한 방식대로 계산한 precision, recall, f1_score이고, weighted avg는 각 데이터의 숫자만큼 가중 시킨 값인데, <strong>실제로는 macro avg로 평가하는 것이 가장 바람직합니다.</strong> <br><br></p>
<p>weighted avg의 경우 imbalanced 데이터를 사용할 때에도 가중치를 곱해버려서 틀린 클래스의 imbalanced 했다면 거의 반영이 안됩니다. 가령 이전 예시처럼 1000명의 환자중 900명을 맞추고 100명이 틀렸다면 맞춘 900명에 가중치를 0.9를 주고, 틀린 100명에 가중치를 0.1을 주는데, 이렇게 하면 accuracy와 별반 다를게 없어집니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h3 id="7.-Confusion-Matrix-(혼잡-행렬)">
<a class="anchor" href="#7.-Confusion-Matrix-(%ED%98%BC%EC%9E%A1-%ED%96%89%EB%A0%AC)" aria-hidden="true"><span class="octicon octicon-link"></span></a>7. Confusion Matrix (혼잡 행렬)<a class="anchor-link" href="#7.-Confusion-Matrix-(%ED%98%BC%EC%9E%A1-%ED%96%89%EB%A0%AC)"> </a>
</h3>
<p>혼잡행렬이라는 평가 기법도 있습니다. 이 것은 어떠한 정량적인 메트릭은 아니고, 정성적으로 눈으로 보면서 평가 할 수 있게 도와줍니다. 각 클래스별로 얼마나 맞췄는지에 대한 것으로 sklearn에서는 <code>from sklearn.metrics import confusion_matrix</code>를 이용하면 사용할 수 있습니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">predict</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">predict</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[11  0  0]
 [ 3  1  0]
 [ 1  1  2]]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>0번 클래스의 경우 11개중 11개를 0으로, 0개를 1로, 0개를 2로 예측하였습니다. </li>
<li>1번 클래스의 경우 4개중 3개를 0으로, 1개를 1로, 0개를 2로 예측하였습니다.</li>
<li>2번 클래스의 경우 1개를 0으로, 1개를 1로, 2개를 2로 예측하였습니다.</li>
</ul>
<p>이를 matplotlib이나 seaborn 등으로 시각화하면 아래처럼 예쁘게 시각화 할 수 있습니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> 

<span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">predict</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">cmatrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">predict</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">'figure.figsize'</span><span class="p">:(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">)})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cmatrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x227388f4390&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> 
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="k">def</span> <span class="nf">draw_plt_matrix</span><span class="p">(</span><span class="n">cm</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        metrics에서 출력된 confusion matrix을 시각화해서 그리고 저장합니다.</span>

<span class="sd">        :param cm: confusion matrix 객체</span>
<span class="sd">        """</span>
        
        <span class="n">label_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'Blues'</span><span class="p">)</span>
        <span class="n">cm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float'</span><span class="p">)</span> <span class="o">/</span> <span class="n">cm</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        
        <span class="n">tick_marks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">label_length</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
        <span class="n">thresh</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="mf">1.5</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">"</span><span class="si">{:0.4f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]),</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">"center"</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="s2">"white"</span> <span class="k">if</span> <span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">thresh</span> <span class="k">else</span> <span class="s2">"black"</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">predict</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">cmatrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">predict</span><span class="p">)</span>

<span class="n">draw_plt_matrix</span><span class="p">(</span><span class="n">cm</span><span class="o">=</span><span class="n">cmatrix</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h3 id="7.-Overfitting">
<a class="anchor" href="#7.-Overfitting" aria-hidden="true"><span class="octicon octicon-link"></span></a>7. Overfitting<a class="anchor-link" href="#7.-Overfitting"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Overfitting은 공통적인 특징을 학습하는 것에 그치지 않고, 각각 샘플들의 자세한 특징까지 학습하여 나타나는 현상입니다.
<br><br></p>
<p><img src="https://github.com/gusdnd852/bigdata-lecture/blob/master/_notebooks/img/Day5/bao_1.png" alt=""><br></p>
<p>예를 들어, 지폐를 구분하는 모델을 만들고 학습 데이터로 원화, 달러, 엔화를 사용하여 학습을 시켜봅시다.
<br><br></p>
<p><img src="https://github.com/gusdnd852/bigdata-lecture/blob/master/_notebooks/img/Day5/bao_2.png" alt=""><br></p>
<p>모델은 직사각형 사이즈에, 금액이 적혀있고, 일련번호가 적힌 것들을 지폐라고 분류할 수 있게 되었습니다.
<br><br></p>
<p>여기서 그치지 않고 새로운 특징으로 "사람의 얼굴이 있다"는 것을 학습시켜 보았습니다. 더 자세한 특징을 학습시켰으니 모델이 더 정확한 판단을 내릴수 있다고 생각할 것입니다. 하지만, 아래와 같이 결과는 더 나빠집니다. 사람의 얼굴이 없는 지폐는 지폐가 아니라고 판단해버리게 되었습니다.</p>
<p><img src="https://github.com/gusdnd852/bigdata-lecture/blob/master/_notebooks/img/Day5/bao_3.png" alt="">
<br><br></p>
<p>이처럼, 샘플 데이터만 가지고 너무 자세한 특징까지 학습하게 되어 새로운 데이터에 대해 예측하지 못하는 현상을 overfitting이라고 합니다. 실제 데이터에서 우리가 회귀나 분류 등을 수행할 때는 아래처럼 선을 긋는다고 하였습니다.</p>
<p><img src="https://t1.daumcdn.net/thumb/R720x0/?fname=http://t1.daumcdn.net/brunch/service/user/Jr9/image/SbI5NgVY5ZLzvG6QCT8hUcC00lA.jpg" alt="">
<br><br></p>
<p>위의 3장의 이미지를 봅시다. 가장 왼쪽 그림은 underfitting(너무 학습이 덜 된 경우)를 의미합니다. 가운데 그림은 적당하게 잘 학습된 모델입니다. 그리고 가장 오른쪽 그림이 오늘 배운 overfitting(학습이 너무 과하게 된 경우)입니다. 보편적인 특징이 아니라 각각 샘플 자체를 암기해버려서, 그 샘플과 완벽하게 똑같지 않다면 틀려버리게 되는 경우입니다. 이러한 overfitting 문제는 꽤나 자주 일어나며 이를 해결하는 것이 머신러닝과 딥러닝의 영원한 숙제라고 할 수 있습니다. <br><br></p>
<p>overfitting문제를 완벽하게 해결하지는 못해도 어느정도 완화할 수는 있는데, 가장 기본적인 방법은 샘플 데이터를 충분히 많이 사용하여 다양한 테스트 데이터에도 예측할 수 있도록 하는 것이며, 이외에도 Regularization과 Dropout등의 방법을 통해 해결할 수 있습니다. 
<br><br></p>

</div>
</div>
</div>
</div>





    <br><br>
    <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = “https://gusdnd852.github.io/evaluation_and_overfitting“;
this.page.identifier = 01. 모델 평가방법 및 오버피팅;
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://gusdnd852.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<a class="u-url" href="/bigdata-lecture/evaluation_and_overfitting" hidden></a>
</article>

<script>
	function run_exec(){
		if("colab" === "binder"){
			if(confirm("이 노트북은 CPU환경인 Binder에서 소스코드를 실행합니다.")){
				var binder_path = "https://mybinder.org/v2/gh/gusdnd852/bigdata-lecture/master?filepath=_notebooks%2F05_01_%EB%AA%A8%EB%8D%B8_%ED%8F%89%EA%B0%80%EB%B0%A9%EB%B2%95%EA%B3%BC_%EC%98%A4%EB%B2%84%ED%94%BC%ED%8C%85.ipynb";
				alert("Binder는 Docker기반의 컨테이너를 직접 빌드하기 때문에 시간이 다소 소요됩니다. Build logs의 show버튼을 눌러서 진행상황을 확인하세요");
				window.open(binder_path, "_blank");
							
			}
			
		}else if("colab" === "colab"){
			if(confirm("이 노트북은 GPU환경인 Google Colab에서 소스코드를 실행합니다.")){
				var colab_path = "https://colab.research.google.com/github/gusdnd852/bigdata-lecture/blob/master/_notebooks/05_01_모델_평가방법과_오버피팅.ipynb";
				alert("GPU 설정을 위해 Colab 상단 메뉴중, 런타임 → 런타임 유형변경에서 GPU를 선택해주세요. (미선택시 CPU에서 실행됨)");
				window.open(colab_path, "_blank");
			}			
		}else{
			alert("해당 실행환경은 구동이 불가능합니다. Binder와 Google Colab 중 한가지를 선택해주세요.");
		}
	}

    function code_listener() {
	var input_area = document.getElementsByClassName("input_area");

	for(var i = 0 ; i < input_area.length; i++){
		input_area[i].onclick = function(){
			run_exec();
    		}
	}

    } 

    code_listener();
</script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/bigdata-lecture/"></data>

  <div class="wrapper">
      <div class="footer-col">
	<footer-elem class=px-2>
		<a href="https://github.com/gusdnd852">
			<svg class="social svg-icon">
				<use xlink:href="/bigdata-lecture/assets/minima-social-icons.svg#github"></use>
			</svg>
			<span class="username">Github</span>
		</a>
	</footer-elem>

	<footer-elem class=px-2>
		<a href="https://youtube.com/channel/UCb7DJAuj1LulbY8WEr2EDUw">
			<svg class="social svg-icon">
				<use xlink:href="/bigdata-lecture/assets/minima-social-icons.svg#youtube"></use>
			</svg>
			<span class="username">Youtube</span>
		</a>
	</footer-elem>

	<footer-elem class=px-2>
		<a href="https://www.facebook.com/gusdnd852">
			<svg class="social svg-icon">
				<use xlink:href="/bigdata-lecture/assets/minima-social-icons.svg#facebook"></use>
			</svg>
			<span class="username">Facebook</span>
		</a>
	</footer-elem>
	<br>
	<div class="copyright">
		© Copyright 2020 Hyunwoong Go. All rights reserved.
	</div>
      </div>
  </div>
</footer>
</body>
</html>

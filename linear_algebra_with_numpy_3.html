<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" type="image/x-icon" href="/bigdata-lecture/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>선형대수와 Numpy 프로그래밍 (3) | TensorFlow로 시작하는 머신러닝 &amp; 딥러닝</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="선형대수와 Numpy 프로그래밍 (3)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="머신러닝에 꼭 필요한 선형대수학 개념들을 배우고 이를 Numpy로 구현하는 방법을 배워봅시다." />
<meta property="og:description" content="머신러닝에 꼭 필요한 선형대수학 개념들을 배우고 이를 Numpy로 구현하는 방법을 배워봅시다." />
<link rel="canonical" href="https://gusdnd852.github.io/bigdata-lecture/linear_algebra_with_numpy_3" />
<meta property="og:url" content="https://gusdnd852.github.io/bigdata-lecture/linear_algebra_with_numpy_3" />
<meta property="og:site_name" content="TensorFlow로 시작하는 머신러닝 &amp; 딥러닝" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-15T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://gusdnd852.github.io/bigdata-lecture/linear_algebra_with_numpy_3","@type":"BlogPosting","headline":"선형대수와 Numpy 프로그래밍 (3)","dateModified":"2020-07-15T00:00:00-05:00","datePublished":"2020-07-15T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://gusdnd852.github.io/bigdata-lecture/linear_algebra_with_numpy_3"},"description":"머신러닝에 꼭 필요한 선형대수학 개념들을 배우고 이를 Numpy로 구현하는 방법을 배워봅시다.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
  <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css">
    <link rel="stylesheet" href="/bigdata-lecture/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://gusdnd852.github.io/bigdata-lecture/feed.xml" title="TensorFlow로 시작하는 머신러닝 & 딥러닝" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
          ]}
        );
      });
    </script>
  

  <script>
  function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
  }
  window.onload = wrap_img;
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function(){
      // add link icon to anchor tags
      var elem = document.querySelectorAll(".anchor-link")
      elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
      // remove paragraph tags in rendered toc (happens from notebooks)
      var toctags = document.querySelectorAll(".toc-entry")
      toctags.forEach(e => (e.firstElementChild.innerText = e.firstElementChild.innerText.replace('¶', '')))
    });
  </script>
</head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>

     @media screen and (max-width : 511px) {
         body { 
		font-size: 0.84rem; 
	}pre, code, blockquote {
		font-size: 0.84rem !important;
	}
	.katex, .mord {
		font: normal 1.02em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.90em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 0.9rem !important;
	}
	.contents-left{
		display: none !important;
	}
	.contents-right, .contents-left {
    		display: block;
    		text-align: center;
		margin-left: 0px !important;
    		margin-right: 0px !important;
    		list-style: none;
    	}
	.mobile_hide{
		display: none;
	}
	.contents-right > li {
    		display: inline-block;
    		margin: 3px;
    		word-break: keep-all;
	}
     }
 

     @media screen and (min-width : 512px) and (max-width : 767px) {
         body { 
		font-size: 0.92rem; 
	}pre, code, blockquote {
		font-size: 0.92rem !important;
	}
	.katex, .mord {
		font: normal 1.04em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.92em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 1.0rem !important;
	}
	.contents-left{
		display: none !important;
	}
	.contents-right, .contents-left {
    		display: block;
    		text-align: center;
		margin-left: 0px !important;
    		margin-right: 0px !important;
    		list-style: none;
    	}    
	.mobile_hide{
		display: none !important;
	}
	.contents-right > li {
    		display: inline-block;
    		margin: 3px;
    		word-break: keep-all;
	}
     }
 
     @media screen and (min-width : 768px) and (max-width : 1024px) {
         body {
		 font-size: 1.0rem; 
	}pre, code, blockquote {
		font-size: 1.0rem !important;
	}
	.katex, .mord {
		font: normal 1.05em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.93em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 1.1rem !important;
	}
	.contents-right, .contents-left {
		display: inline-block;
    		vertical-align: top;
    		text-align: left;
		list-style: none;
    	}  
	.contents-left{
		margin-left: 20px !important;
    		margin-right: 3.0rem;
	}
	.mobile_hide{
		display: block !important;
	}
     }

     @media screen and (min-width : 1025px) {
         body { 
		font-size: 1.08rem; 
	}pre, code, blockquote {
		font-size: 1.08rem !important;
	}
     	.katex, .mord {
		font: normal 1.06em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.94em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 1.2rem !important;
	}
	.contents-right, .contents-left {
    		display: inline-block;
    		vertical-align: top;
    		text-align: left;
		list-style: none;
    	}
	.contents-right > h2, .contents-left > h2 {
    		margin-botton: 2px
	}  
	.contents-left{
    		margin-left: 0 !important;
    		margin-right: 3.0rem;
	}
	.mobile_hide{
		display: block !important;
	}
     }

    </style>
  <body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" style="font-size:1.2rem;" href="/bigdata-lecture/">TensorFlow로 시작하는 머신러닝 &amp; 딥러닝 </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/bigdata-lecture/lecture">Lecture</a><a class="page-link" href="/bigdata-lecture/orientation">Orientation</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content" style="flex: none;" >
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h3 class="post-title p-name" itemprop="name headline">05. 선형대수와 Numpy 프로그래밍 (3)</h3><p class="page-description">머신러닝에 꼭 필요한 선형대수학 개념들을 배우고 이를 Numpy로 구현하는 방법을 배워봅시다.</p
      <i class="fas fa-tags category-tags-icon"></i><p class="category-tags"> 
      
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
	
	<div class="px-1">
    <a href="https://colab.research.google.com/github/gusdnd852/bigdata-lecture/blob/master/_notebooks/01_05_선형대수와_numpy_프로그래밍_(3).ipynb" target="_blank">
        <img class="notebook-badge-image" src="/bigdata-lecture/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
	
	<div class="px-1">
<a href="https://github.com/gusdnd852/bigdata-lecture/tree/master/_notebooks/01_05_선형대수와_numpy_프로그래밍_(3).ipynb" role="button">
    <img class="notebook-badge-image" src="https://img.shields.io/static/v1?label=&message=View%20On%20GitHub&color=586069&logo=github&labelColor=2f363d">
</a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#1.-Tensor">1. Tensor </a></li>
<li class="toc-entry toc-h3"><a href="#2.-Tensor의-Shape-규칙">2. Tensor의 Shape 규칙 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#2.1.-3차원-텐서-Shape-규칙">2.1. 3차원 텐서 Shape 규칙 </a></li>
<li class="toc-entry toc-h4"><a href="#2.2.-4차원-텐서-Shape-규칙">2.2. 4차원 텐서 Shape 규칙 </a></li>
<li class="toc-entry toc-h4"><a href="#2.3.-n차원-텐서-Shape-규칙">2.3. n차원 텐서 Shape 규칙 </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#3.-Axis">3. Axis </a></li>
<li class="toc-entry toc-h3"><a href="#4.-텐서-및-행렬-연산">4. 텐서 및 행렬 연산 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#4.1.-transpose-(전치행렬)">4.1. transpose (전치행렬) </a></li>
<li class="toc-entry toc-h4"><a href="#4.2.-reshpae-(shape-및-Rank-변경)">4.2. reshpae (shape 및 Rank 변경) </a></li>
<li class="toc-entry toc-h4"><a href="#4.3.-squeeze-(쥐어-짜기)">4.3. squeeze (쥐어 짜기) </a></li>
<li class="toc-entry toc-h4"><a href="#4.4.-expand_dims-(=-unsqueeze,-차원-증가)">4.4. expand_dims (= unsqueeze, 차원 증가) </a></li>
<li class="toc-entry toc-h4"><a href="#4.5.-concatenate-(접합)">4.5. concatenate (접합) </a></li>
<li class="toc-entry toc-h4"><a href="#4.6.-split-(자르기)">4.6. split (자르기) </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#5.-텐서-생성-연산">5. 텐서 생성 연산 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#5.1.-rand">5.1. rand </a></li>
<li class="toc-entry toc-h4"><a href="#5.2.-ones">5.2. ones </a></li>
<li class="toc-entry toc-h4"><a href="#5.2.-zeros">5.2. zeros </a></li>
<li class="toc-entry toc-h4"><a href="#5.3.-arrange">5.3. arrange </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#6.-Distance-&-Norm">6. Distance &amp; Norm </a>
<ul>
<li class="toc-entry toc-h4"><a href="#6.1.-Distance">6.1. Distance </a></li>
<li class="toc-entry toc-h4"><a href="#6.2.-Norm">6.2. Norm </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/01_05_선형대수와_numpy_프로그래밍_(3).ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>이제 여러분은 어느정도는 선형대수라는 프레임워크를 이용해 수를 생각할 수 있게 되었습니다. 이제 행렬보다 상위 차원 존재인 텐서에 대해 배우고, 데이터를 자르고 붙이고 돌리는 방법들에 대해 배워봅시다. 이러한 함수들은 실제로 꽤나 유용하며, 이런 함수들을 잘 모르면 머신러닝 프로그래밍 자체가 불가능하니 잘 봐주셔야합니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-Tensor">
<a class="anchor" href="#1.-Tensor" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Tensor<a class="anchor-link" href="#1.-Tensor"> </a>
</h3>
<p>행렬은 기본적으로 벡터가 여러개 쌓여서 만들어진 구조입니다. (기저벡터들이 변환되고 난 뒤의 위치를 가로로 쌓아놓은 구조) 따라서 (n) 혹은 (n, 1)의 Shape를 갖는 벡터들이 m개 쌓이면 Shape이 (n, m)인 행렬이 되는 방식이였습니다.</p>
<p><img src="https://github.com/gusdnd852/bigdata-lecture/blob/master/_notebooks/img/Day1/70.png?raw=true" alt="img"></p>
<p>그러나 이러한 행렬이 쌓여서 3차원 큐브와 같은 자료를 만들면 어떻게 될까요? 또 그 3차원 큐브가 쌓여서 4차원 데이터를 만들어내면 어떻게 될까요? 이 때 데이터 자체가 몇개의 방향(차원)으로 존재하는지를 우리는 "랭크(Rank)"라고 부릅니다. <br><br></p>
<p><img src="https://github.com/gusdnd852/bigdata-lecture/blob/master/_notebooks/img/Day1/69.png?raw=true" alt="img"></p>
<p>스칼라는 랭크가 0, 벡터는 랭크가 1, 행렬은 랭크가 2입니다. 그리고 랭크가 3이상인 모든 데이터들을 "텐서"라고 부르며, 우리는 앞으로 이 텐서를 다룰 것입니다.
<br><br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.-Tensor의-Shape-규칙">
<a class="anchor" href="#2.-Tensor%EC%9D%98-Shape-%EA%B7%9C%EC%B9%99" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Tensor의 Shape 규칙<a class="anchor-link" href="#2.-Tensor%EC%9D%98-Shape-%EA%B7%9C%EC%B9%99"> </a>
</h3>
<p>Tensor의 경우 Rank가 높기 때문에 Shape을 맞추기 까다롭습니다. 아래와 같은 규칙이 존재합니다.
<br></p>
<p><img src="https://2.bp.blogspot.com/-iuS-Uayk2FA/T_VUQ3nvaiI/AAAAAAAAAhs/ARvCwQFufsc/s1600/matrix_multi.png" alt="">
<br><br></p>
<h4 id="2.1.-3차원-텐서-Shape-규칙">
<a class="anchor" href="#2.1.-3%EC%B0%A8%EC%9B%90-%ED%85%90%EC%84%9C-Shape-%EA%B7%9C%EC%B9%99" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.1. 3차원 텐서 Shape 규칙<a class="anchor-link" href="#2.1.-3%EC%B0%A8%EC%9B%90-%ED%85%90%EC%84%9C-Shape-%EA%B7%9C%EC%B9%99"> </a>
</h4>
<p>(x, i, j) @ (x, j, k)을 연산할 때 x는 같거나 양쪽 중 한쪽이 1이여야 하며, 맨 끝 두개의 Shape은 (i, j) @ (j, k)에서 j는 동일해야하고, 결과 Shape은 (x, i, k)가 된다.
<br></p>
<ul>
<li>(4, 1, 2) @ (4, 2, 5) = (4, 1, 5)</li>
<li>(4, 1, 2) @ (3, 2, 5) = 가장 앞자리가 달라서 에러</li>
<li>(1, 1, 2) @ (3, 2, 5) = (3, 1, 5) 
<br><br>
</li>
</ul>
<h4 id="2.2.-4차원-텐서-Shape-규칙">
<a class="anchor" href="#2.2.-4%EC%B0%A8%EC%9B%90-%ED%85%90%EC%84%9C-Shape-%EA%B7%9C%EC%B9%99" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.2. 4차원 텐서 Shape 규칙<a class="anchor-link" href="#2.2.-4%EC%B0%A8%EC%9B%90-%ED%85%90%EC%84%9C-Shape-%EA%B7%9C%EC%B9%99"> </a>
</h4>
<p>(x, y, i, j) @ (x, y, j, k)을 연산할 때 x, y는 같거나 양쪽 중 한쪽이 1이여야 하며, 맨 끝 두개의 Shape은 (i, j) @ (j, k)에서 j는 동일해야하고, 결과 Shape은 (x, y, i, k)가 된다.
<br></p>
<ul>
<li>(4, 3, 1, 2) @ (4, 3, 2, 5) = (4, 3, 1, 5)</li>
<li>(4, 5, 1, 2) @ (3, 5, 2, 5) = 가장 앞자리가 달라서 에러</li>
<li>(4, 5, 1, 2) @ (4, 3, 2, 5) = 두번째 자리가 달라서 에러</li>
<li>(4, 5, 1, 2) @ (4, 1, 2, 5) = (4, 5, 1, 5)</li>
<li>(4, 5, 1, 2) @ (1, 5, 2, 5) = (4, 5, 1, 5)
<br><br>
</li>
</ul>
<h4 id="2.3.-n차원-텐서-Shape-규칙">
<a class="anchor" href="#2.3.-n%EC%B0%A8%EC%9B%90-%ED%85%90%EC%84%9C-Shape-%EA%B7%9C%EC%B9%99" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.3. n차원 텐서 Shape 규칙<a class="anchor-link" href="#2.3.-n%EC%B0%A8%EC%9B%90-%ED%85%90%EC%84%9C-Shape-%EA%B7%9C%EC%B9%99"> </a>
</h4>
<p>위를 토대로 아래와 같은 일반화가 가능합니다.</p>
<p>(x, ..., z, i, j) @ (x, ..., z, j, k)을 연산할 때 x, ..., z는 같거나 양쪽 중 한쪽이 1이여야 하며, 맨 끝 두개의 Shape은 (i, j) @ (j, k)에서 j는 동일해야하고, 결과 Shape은 (x, ..., z, i, k)가 된다.
<br></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span>

<span class="nb">print</span><span class="p">((</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(4, 1, 5)
(3, 1, 5)
(4, 3, 1, 5)
(4, 5, 1, 5)
(4, 5, 1, 5)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h3 id="3.-Axis">
<a class="anchor" href="#3.-Axis" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Axis<a class="anchor-link" href="#3.-Axis"> </a>
</h3>
<p>Axis는 축이라는 뜻입니다. Shape에서 몇번째 Shape을 지정할지 나타낼 때 많이 사용합니다. 가령 (4, 1, 3)의 Shape을 가진 텐서가 있다면, Axis 0은 4이며, Axis 1은 1, Axis 2는 3이 됩니다. 몇번째 자리수를 나타내는지 사용할 때 씁니다. <br><br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.-텐서-및-행렬-연산">
<a class="anchor" href="#4.-%ED%85%90%EC%84%9C-%EB%B0%8F-%ED%96%89%EB%A0%AC-%EC%97%B0%EC%82%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. 텐서 및 행렬 연산<a class="anchor-link" href="#4.-%ED%85%90%EC%84%9C-%EB%B0%8F-%ED%96%89%EB%A0%AC-%EC%97%B0%EC%82%B0"> </a>
</h3>
<p>텐서나 행렬은 매우 다양한 연산을 지원합니다. 아래의 구체적인 예시를 봅시다.
<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="4.1.-transpose-(전치행렬)">
<a class="anchor" href="#4.1.-transpose-(%EC%A0%84%EC%B9%98%ED%96%89%EB%A0%AC)" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.1. transpose (전치행렬)<a class="anchor-link" href="#4.1.-transpose-(%EC%A0%84%EC%B9%98%ED%96%89%EB%A0%AC)"> </a>
</h4>
<p>$\begin{bmatrix} 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \end{bmatrix}^T$ = $\begin{bmatrix} 1 &amp; 4 \\ 2 &amp; 5 \\ 3 &amp; 6 \end{bmatrix}$</p>
<p>트랜스포즈 연산은 행렬을 뒤집는 것을 의미합니다. 만약 Shape가 (2, 3)인 행렬이였다면 뒤집고나서는 Shape가 (3, 2)가 됩니다. 수식 표기는 $A^T$와 같이 T를 붙여서 표기합니다. numpy에서는 .T로 손쉽게 행렬을 트랜스포즈 할 수 있습니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">mat_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> 
                  <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>

<span class="n">mat_a</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1, 4],
       [2, 5],
       [3, 6]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<p>텐서의 경우, 랭크가 2보다 높을 수 있습니다. 각 자리의 순서를 바꾸고 싶을 때 transpose() 연산을 사용할 수 있습니다. 랭크가 3일 때 기본값은 (0, 1, 2)으로 생각하고, 0번째 1번째 2번째 Shape의 위치를 마음대로 변경합니다. 예를 들어 numpy에서는 transpose(0, 2, 1)이나 transpose(1, 0, 2)처럼 변경 가능합니다.
<br><br></p>
<ul>
<li>Shape : (4, 5, 7) ← ([0]:4, [1]:5, [2]:7)</li>
<li>transpose(0, 1, 2) : (4, 5, 7)</li>
<li>transpose(0, 2, 1) : (4, 7, 5)</li>
<li>transpose(1, 2, 0) : (7, 5, 4)</li>
<li>transpose(1, 0, 2) : (5, 4, 7)</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mat_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
                  <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
                  <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
                  <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]])</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">'Shape : '</span><span class="p">,</span> <span class="n">mat_a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'transpose(0, 1, 2) : '</span><span class="p">,</span> <span class="n">mat_a</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'transpose(0, 2, 1) : '</span><span class="p">,</span> <span class="n">mat_a</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'transpose(1, 0, 2) : '</span><span class="p">,</span> <span class="n">mat_a</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'transpose(1, 2, 0) : '</span><span class="p">,</span> <span class="n">mat_a</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Shape :  (4, 2, 3)
transpose(0, 1, 2) :  (4, 2, 3)
transpose(0, 2, 1) :  (4, 3, 2)
transpose(1, 0, 2) :  (2, 4, 3)
transpose(1, 2, 0) :  (2, 3, 4)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br><br></p>
<h4 id="4.2.-reshpae-(shape-및-Rank-변경)">
<a class="anchor" href="#4.2.-reshpae-(shape-%EB%B0%8F-Rank-%EB%B3%80%EA%B2%BD)" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.2. reshpae (shape 및 Rank 변경)<a class="anchor-link" href="#4.2.-reshpae-(shape-%EB%B0%8F-Rank-%EB%B3%80%EA%B2%BD)"> </a>
</h4>
<p><img src="https://i.stack.imgur.com/OUjlv.png" alt="">
<br></p>
<p>reshape 연산은 행렬이나 텐서의 일부분을 떼내서 다른 모양으로 재조직합니다. 때문에 Shape을 마음대로 바꿀 수 있습니다. 단 일정한 규칙 안에서 변경 가능한데, 해당하는 텐서의 Shape에서 각 Axis들의 곱으로 만들어낼 수 있는 Shape만 변경 가능합니다. numpy에서는 reshape()이라는 함수로 사용 가능합니다. 아래 예시를 봅시다.
<br><br></p>
<ul>
<li>(4, 2, 3) → reshape(4, 2 x 3) → (4, 6)</li>
<li>(4, 3, 2) → reshape(4 x 2, 3) → (8, 3)</li>
<li>(4, 3, 2) → reshape(4 x 2 x 3, 1) → (24, 1)</li>
<li>(4, 3, 2) → reshape(1, 4 x 2 x 3) → (1, 24)</li>
<li>(4, 3, 2) → reshape(4 x 2 x 3) → (24)</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mat_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
                  <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
                  <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
                  <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]])</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">'Shape : '</span><span class="p">,</span> <span class="n">mat_a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'reshape(4, 2 * 3) : '</span><span class="p">,</span> <span class="n">mat_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'reshape(4 * 2, 3) : '</span><span class="p">,</span> <span class="n">mat_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'reshape(4 * 2 * 3) : '</span><span class="p">,</span> <span class="n">mat_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'reshape(1, 4 * 2 * 3) : '</span><span class="p">,</span> <span class="n">mat_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'reshape(4 * 2 * 3, 1) : '</span><span class="p">,</span> <span class="n">mat_a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Shape :  (4, 2, 3)
reshape(4, 2 * 3) :  (4, 6)
reshape(4 * 2, 3) :  (8, 3)
reshape(4 * 2 * 3) :  (24,)
reshape(1, 4 * 2 * 3) :  (1, 24)
reshape(4 * 2 * 3, 1) :  (24, 1)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h4 id="4.3.-squeeze-(쥐어-짜기)">
<a class="anchor" href="#4.3.-squeeze-(%EC%A5%90%EC%96%B4-%EC%A7%9C%EA%B8%B0)" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3. squeeze (쥐어 짜기)<a class="anchor-link" href="#4.3.-squeeze-(%EC%A5%90%EC%96%B4-%EC%A7%9C%EA%B8%B0)"> </a>
</h4>
<p>squeeze연산은 크기가 1인 Axis를 제거합니다. 텐서를 쥐어짜서 필요 없는 차원을 없앤다고 봐도 무방합니다 (그래서 이름이 squeeze인듯 합니다.)</p>
<ul>
<li>Shape : (4, 1, 2) → squeeze : (4, 2)</li>
<li>Shape : (4, 1, 1, 1, 2) → squeeze : (4, 2)</li>
<li>Shape : (1, 4, 1, 2) → squeeze : (4, 2)</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">'origin : '</span><span class="p">,</span> <span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">'squeeze : '</span><span class="p">,</span> <span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'origin : '</span><span class="p">,</span> <span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">'squeeze : '</span><span class="p">,</span> <span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'origin : '</span><span class="p">,</span> <span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">'squeeze : '</span><span class="p">,</span> <span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>origin :  (4, 1, 2) squeeze :  (4, 2)
origin :  (4, 1, 1, 1, 2) squeeze :  (4, 2)
origin :  (1, 4, 1, 2) squeeze :  (4, 2)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h4 id="4.4.-expand_dims-(=-unsqueeze,-차원-증가)">
<a class="anchor" href="#4.4.-expand_dims-(=-unsqueeze,-%EC%B0%A8%EC%9B%90-%EC%A6%9D%EA%B0%80)" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4. expand_dims (= unsqueeze, 차원 증가)<a class="anchor-link" href="#4.4.-expand_dims-(=-unsqueeze,-%EC%B0%A8%EC%9B%90-%EC%A6%9D%EA%B0%80)"> </a>
</h4>
<p>expand_dims연산은 unsqueeze라고도 부르는데 squeeze와 반대로 원하는 Axis에 크기가 1인 Axis를 새로 만듭니다. numpy에서는 np.expand_dims(a, 0)과 같이 사용합니다.</p>
<ul>
<li>Shape : (4, 2) → expand_dims(0) : (1, 4, 2)</li>
<li>Shape : (4, 2) → expand_dims(1) : (4, 1, 2)</li>
<li>Shape : (4, 2) → expand_dims(2) : (4, 2, 1)</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">'expand_dims(0) : '</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'expand_dims(1) : '</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'expand_dims(2) : '</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>expand_dims(0) :  (1, 4, 2)
expand_dims(1) :  (4, 1, 2)
expand_dims(2) :  (4, 2, 1)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h4 id="4.5.-concatenate-(접합)">
<a class="anchor" href="#4.5.-concatenate-(%EC%A0%91%ED%95%A9)" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.5. concatenate (접합)<a class="anchor-link" href="#4.5.-concatenate-(%EC%A0%91%ED%95%A9)"> </a>
</h4>
<p><img src="https://www.w3resource.com/w3r_images/python-numpy-image-exercise-58.png" alt=""></p>
<p>두 텐서를 이어 붙여서 새로운 텐서를 만듭니다. 가령 (4, 1, 2)와 (4, 1, 2)를 이어붙여서 (8, 1, 2)와 같이 만듭니다. 어디에 이어 붙일지는 axis로 선택 가능합니다. numpy에서는 np.concatenate([a, b, c, ...], axis=n)과 같이 사용합니다. 전체에서 가장 많이 쓰이는 연산 중 하나이니 꼭 숙지해야합니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span>

<span class="n">tensor_a</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">tensor_b</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">tensor_a</span><span class="p">,</span> <span class="n">tensor_b</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">tensor_a</span><span class="p">,</span> <span class="n">tensor_b</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">tensor_a</span><span class="p">,</span> <span class="n">tensor_b</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(8, 1, 2)
(4, 2, 2)
(4, 1, 4)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h4 id="4.6.-split-(자르기)">
<a class="anchor" href="#4.6.-split-(%EC%9E%90%EB%A5%B4%EA%B8%B0)" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.6. split (자르기)<a class="anchor-link" href="#4.6.-split-(%EC%9E%90%EB%A5%B4%EA%B8%B0)"> </a>
</h4>
<p><img src="https://www.w3resource.com/w3r_images/numpy-manipulation-split-function-image-a.png" alt=""></p>
<p>concatenate와 반대로 텐서를 여러개로 자릅니다. axis=m에서 n개로 자르려면 numpy에서는 np.split(a, n, axis=m)처럼 사용합니다. concatenate처럼 자주 사용되니 알아둬야합니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span>

<span class="n">tensor_a</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'원본 Shape: '</span><span class="p">,</span> <span class="n">tensor_a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">splited</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">tensor_a</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># 2개로 자름</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'axis=0에서 2개로 자름 : '</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">splited</span><span class="p">])</span>

<span class="n">splited</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">tensor_a</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># 4개로 자름</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'axis=0에서 4개로 자름 : '</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">splited</span><span class="p">])</span>

<span class="n">splited</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">tensor_a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># axis=2에서 2개로 자름</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'axis=2에서 2개로 자름 : '</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">splited</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>원본 Shape:  (4, 1, 2)
axis=0에서 2개로 자름 :  [(2, 1, 2), (2, 1, 2)]
axis=0에서 4개로 자름 :  [(1, 1, 2), (1, 1, 2), (1, 1, 2), (1, 1, 2)]
axis=2에서 2개로 자름 :  [(4, 1, 1), (4, 1, 1)]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br><br></p>
<h3 id="5.-텐서-생성-연산">
<a class="anchor" href="#5.-%ED%85%90%EC%84%9C-%EC%83%9D%EC%84%B1-%EC%97%B0%EC%82%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>5. 텐서 생성 연산<a class="anchor-link" href="#5.-%ED%85%90%EC%84%9C-%EC%83%9D%EC%84%B1-%EC%97%B0%EC%82%B0"> </a>
</h3>
<p>기본적으로 지금까지 numpy.array([1, 2, 3])과 같은 방식으로 numpy 벡터/행렬/텐서 등을 직접 지정해서 생성했습니다. 그러나 이 방법 말고도 다양한 생성 방법이 존재합니다.
<br></p>
<h4 id="5.1.-rand">
<a class="anchor" href="#5.1.-rand" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.1. rand<a class="anchor-link" href="#5.1.-rand"> </a>
</h4>
<p>위 예시에서 자주 사용했던 rand입니다. 주어진 Shape로 랜덤 값을 생성합니다.
np.random.rand(shape)와 같이 사용할 수 있습니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[[0.40423873, 0.20384893, 0.40205417],
        [0.19334684, 0.06202334, 0.94376573]],

       [[0.23077679, 0.15761586, 0.84891135],
        [0.39147286, 0.18499911, 0.2066128 ]]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h4 id="5.2.-ones">
<a class="anchor" href="#5.2.-ones" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.2. ones<a class="anchor-link" href="#5.2.-ones"> </a>
</h4>
<p>주어진 Shape로 1로 초기화된 텐서를 생성합니다. np.ones((shape))와 같이 사용합니다. 주의할 점은 ()괄호로 shape을 한번 감싸줘야합니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[[1., 1., 1.],
        [1., 1., 1.]],

       [[1., 1., 1.],
        [1., 1., 1.]]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h4 id="5.2.-zeros">
<a class="anchor" href="#5.2.-zeros" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.2. zeros<a class="anchor-link" href="#5.2.-zeros"> </a>
</h4>
<p>주어진 Shape로 0로 초기화된 텐서를 생성합니다. np.zeros((shape))와 같이 사용합니다. 주의할 점은 ()괄호로 shape을 한번 감싸줘야합니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[[0., 0., 0.],
        [0., 0., 0.]],

       [[0., 0., 0.],
        [0., 0., 0.]]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h4 id="5.3.-arrange">
<a class="anchor" href="#5.3.-arrange" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.3. arrange<a class="anchor-link" href="#5.3.-arrange"> </a>
</h4>
<p>주어진 크기로 점점 증가하는 행 벡터를 생성합니다. np.arrange(size)와 같이 사용합니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h3 id="6.-Distance-&amp;-Norm">
<a class="anchor" href="#6.-Distance-&amp;-Norm" aria-hidden="true"><span class="octicon octicon-link"></span></a>6. Distance &amp; Norm<a class="anchor-link" href="#6.-Distance-&amp;-Norm"> </a>
</h3>
<p>Distance는 텐서 사이의 거리, Norm은 텐서의 길이를 나타냅니다. 마지막으로 이들에 대해 학습해봅시다.
<br><br></p>
<h4 id="6.1.-Distance">
<a class="anchor" href="#6.1.-Distance" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.1. Distance<a class="anchor-link" href="#6.1.-Distance"> </a>
</h4>
<p>Distance는 말 그대로 텐서와 텐서 사이의 거리를 나타냅니다. 일반적으로 두 점 사이의 거리(유클리디안 거리)는 아래와 같이 나타낼 수 있습니다.</p>
<p><img src="https://mblogthumb-phinf.pstatic.net/MjAxODA0MjhfMTUy/MDAxNTI0OTE2NzE1MDE2.AM35pyBBlAll3OsKna2d4bX4GMoifemnj0Wy5VRrKIwg.dYmu6wzSk3RqjTCilmVVnizYbPENZkZxZnORZj0ZybYg.JPEG.galaxyenergy/1524914716171.jpg?type=w800" alt="">
<br></p>
<p>예를 들어 $\begin{bmatrix} 2 \\ 3 \end{bmatrix}$와  $\begin{bmatrix} 5 \\ 10 \end{bmatrix}$ 같은 벡터가 있다면 두 벡터 사이의 거리는 $\sqrt{(5 - 2)^2 + (10 - 3)^2}$이 됩니다. 이런 거리를 L2거리, 혹은 유클리디안 거리라고 합니다. 그러면 유클리디안 거리가 아닌 거리도 있을까요? 제곱을 하지 않고 절대값을 사용하는 L1거리, 맨하탄 거리도 있습니다. 아래를 볼까요
<br><br></p>
<p><img src="https://lh3.googleusercontent.com/proxy/AVIWU_vSjlU9Dd8wcYOAAdD7ZkrsQeGjTitT0MSDhTPHqqSkb4EkqGuJ1lrSH_VTD0gr66URFHxYPxLAf-4dJnn6umoY7Fikdn0" alt="">
<br><br></p>
<p>맨하탄 거리는 약간 다릅니다. $\begin{bmatrix} 2 \\ 3 \end{bmatrix}$와  $\begin{bmatrix} 5 \\ 10 \end{bmatrix}$ 같은 벡터가 있다면 두 벡터 사이의 맨하탄 거리는 $|5 - 2| + |10 - 3|$이 됩니다. 이렇게 구하는 거리를 맨하탄 거리, 혹은 L1 거리라고 합니다. 
<br><br></p>
<p><img src="https://mblogthumb-phinf.pstatic.net/MjAxNzA0MTJfMjQ2/MDAxNDkxOTY0NDkyNzUw.pcEqq7JbtHYh31aVcK3RF7xvlOWCfbnV77A9GDyKyZ8g.9L1Un6iGL7n0Slpnrdp57GQS0zecsXTM6jypv72Vk4kg.PNG.samsjang/%EC%BA%A1%EC%B2%98.PNG?type=w2" alt=""></p>
<p>길어지는 식을 시그마를 이용해 간단하게 나타낼 수 있습니다. 맨하탄 거리는 $\sum |a_1 - a_2|$를, 유클리디언 거리는 $\sum \sqrt{(a_1 - a_2)^2}$로 나타낼 수 있습니다. 그렇다면 $\sum \sqrt[3]{(a_1 - a_2)^3}$이나 $\sum \sqrt[4]{(a_1 - a_2)^4}$같은 거리는 없을까요? 있습니다. 이런 거리들을 전부 일반화 시킨 것을 Minkowski(민코프스키) 거리라고 합니다. 민코프스키 거리는 $\sum \sqrt[p]{(a_1 - a_2)^p}$와 같이 나타내고 P = 1일때는 맨하탄 거리, P = 2일때는 유클리디언 거리가 됩니다.
<br><br></p>
<h4 id="6.2.-Norm">
<a class="anchor" href="#6.2.-Norm" aria-hidden="true"><span class="octicon octicon-link"></span></a>6.2. Norm<a class="anchor-link" href="#6.2.-Norm"> </a>
</h4>
<p>Norm(노름)은 벡터나 텐서등의 길이, 크기 등을 나타낼 때 쓰며, $x$의 norm은 $||x||$와 같이 표기합니다. Norm은 위의 거리 공식 $distance = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2}$ 에서 유도할 수 있습니다. 그러나 앞서 배웠듯이 벡터는 원점에서 한 점으로 뻗어나온 직선입니다. 때문에 둘 중 한점의 좌표는 원점(0, 0)으로 생각할 수 있고 이는 즉 $norm = \sqrt{x_2^2 + y_2^2}$와 같이 식을 변경할 수 있습니다. 
<br><br></p>
<p>무슨 말이냐면, 예를 들어 $\begin{bmatrix} 2 \\ 3 \end{bmatrix}$과 같은 벡터가 있다면 원점과의 거리(길이)는 $\sqrt{(0 - 2)^2 + (0-3)^2}$인데, (0, 0)은 계산하는 의미가 없으므로 그냥 $\sqrt{2^2 + 3^2}$가 된다는 것입니다. Norm도 역시 마찬가지로 L1 Norm, L2 Norm 등이 존재하는데, 원점과의 거리를 계산할 때 유클리디언 거리로 계산하면 L2 Norm이 되고, 맨하탄 거리로 계산하면 L1 Norm이 됩니다. L2 norm은 $||x||_2$처럼 표기하고, L1 norm은 $||x||_1$처럼 표기합니다.
<br><br></p>
<p>norm은 numpy의 linalg 패키지에 있는 norm 함수로 매우 쉽게 계산할 수 있습니다. 이 때, ord는 minkowski의 p를 몇으로 설정하지에 관한 것으로 ord가 2이면 유클리디언 거리 ord가 1이면 맨하탄 거리가 됩니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">vec_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="c1"># linalg는 Linear Algebra의 줄임말입니다.</span>
<span class="n">np_l2_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec_a</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sc_l2_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">vec_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># L2 Norm (유클리디안 길이) 계산</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'numpy_l2_norm : '</span><span class="p">,</span> <span class="n">np_l2_norm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'scratch_l2_norm : '</span><span class="p">,</span> <span class="n">sc_l2_norm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>numpy_l2_norm :  3.605551275463989
scratch_l2_norm :  3.605551275463989
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">vec_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="c1"># linalg는 Linear Algebra의 줄임말입니다.</span>
<span class="n">np_l1_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec_a</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sc_l1_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># L1 Norm (맨하탄 길이) 계산</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'numpy_l1_norm : '</span><span class="p">,</span> <span class="n">np_l1_norm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'scratch_l1_norm : '</span><span class="p">,</span> <span class="n">sc_l1_norm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>numpy_l1_norm :  5.0
scratch_l1_norm :  5
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>위와 같이 우리가 앞서서 배운 벡터 norm에 대한 공식과 np.linalg.norm의 계산이 정확히 일치하는 것을 알 수 있습니다.</p>
<p><br></p>
<p>이제 두 벡터 사이의 Distance를 구해봅시다. 두 벡터 사이의 Distance를 구하려면 두 벡터의 차이의 norm을 계산하면 됩니다. 그 이유는 아래를 보면 알 수 있는데요. 제가 앞서서 벡터 합에 대해서만 이야기 했지 벡터 차에 대해서는 이야기 한 적이 없습니다. 따라서 여기에서 간단하게 설명하고 넘어갑니다. 두 벡터의 차이를 계산할 때는 벡터 합처럼 두 벡터의 자리 별로 차이를 계산하면 됩니다. $\begin{bmatrix} 2 \\ 3 \end{bmatrix}$ - $\begin{bmatrix} 1 \\ 1 \end{bmatrix}$ = $\begin{bmatrix} 1 \\ 2 \end{bmatrix}$가 됩니다. 그리고 이렇게 계산하여 나온 벡터는 아래 처럼 두 벡터 사이의 거리를 나타내는 벡터가 됩니다.</p>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcT1NAIJDK0g5MbkKtLRLz_mfAYtOngjZc1mNA&amp;usqp=CAU" alt="">
<br><br></p>
<p>따라서 두 벡터의 차이의 norm을 구하면 그 것이 두 벡터사이의 거리를 나타내는 벡터의 길이가 됩니다. 이해가셨나요? 이러한 사실을 바탕으로 numpy로 구현해보겠습니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">vec_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">vec_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">vec_diff</span> <span class="o">=</span> <span class="n">vec_a</span> <span class="o">-</span> <span class="n">vec_b</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'vector difference : '</span><span class="p">,</span> <span class="n">vec_diff</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'euclidean distance : '</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec_diff</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'manhatten distance : '</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec_diff</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>vector difference :  [1 2]
euclidean distance :  2.23606797749979
manhatten distance :  3.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">vec_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">vec_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'euclidean distance : '</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">vec_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vec_b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vec_b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'manhatten distance : '</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vec_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vec_b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vec_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vec_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>euclidean distance :  2.23606797749979
manhatten distance :  3
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>이렇게 두 벡터의 차인 vec_diff를 구하고 그 diff의 norm을 계산한것과 우리가 알고 있는 거리에 대한 정의를 사용해 계산한 거리가 동일합니다. 따라서 앞으로 거리를 계산할 때는 위 처럼 편의를 위해 벡터 차를 구하고, 그 벡터 차의 norm을 사용하는 것이 바람직 하겠습니다.</p>
<p><br></p>
<p>그렇다면 행렬이나 텐서의 norm은 어떻게 구할까요?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mat_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> 
                  <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>

<span class="n">vec_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mat_a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec_a</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>위를 보면 행렬이나 텐서의 norm을 어떻게 구하는지 알 수 있습니다. 행렬이나 텐서를 쭉 편것과 동일한 벡터의 norm과 동일합니다. 그냥 모든 원소의 값을 가지고 L2 혹은 L1 norm을 계산하면 됩니다. 간단하죠? <br><br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>여기까지 해서 여러분은 하루만에 머신러닝에 필요한 선형대수 내용을 모두 배우셨습니다. 이렇게 복잡하고 어려운 수학을 왜 배웠나 싶으실 수도 있는데 이후에 진행하다 보면 "선형대수 안 들어놓았으면 머신러닝 건들지도 못하겠구나."라는 생각이 자연스레 떠오르실 겁니다. 모두 수고하셨습니다 !</p>

</div>
</div>
</div>
</div>





    <br><br>
    <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = “https://gusdnd852.github.io/linear_algebra_with_numpy_3“;
this.page.identifier = 05. 선형대수와 Numpy 프로그래밍 (3);
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://gusdnd852.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<a class="u-url" href="/bigdata-lecture/linear_algebra_with_numpy_3" hidden></a>
</article>

<script>
	function run_exec(){
		if("colab" === "binder"){
			if(confirm("이 노트북은 CPU환경인 Binder에서 소스코드를 실행합니다.")){
				var binder_path = "https://mybinder.org/v2/gh/gusdnd852/bigdata-lecture/master?filepath=_notebooks%2F01_05_%EC%84%A0%ED%98%95%EB%8C%80%EC%88%98%EC%99%80_numpy_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D_%283%29.ipynb";
				alert("Binder는 Docker기반의 컨테이너를 직접 빌드하기 때문에 시간이 다소 소요됩니다. Build logs의 show버튼을 눌러서 진행상황을 확인하세요");
				window.open(binder_path, "_blank");
							
			}
			
		}else if("colab" === "colab"){
			if(confirm("이 노트북은 GPU환경인 Google Colab에서 소스코드를 실행합니다.")){
				var colab_path = "https://colab.research.google.com/github/gusdnd852/bigdata-lecture/blob/master/_notebooks/01_05_선형대수와_numpy_프로그래밍_(3).ipynb";
				alert("GPU 설정을 위해 Colab 상단 메뉴중, 런타임 → 런타임 유형변경에서 GPU를 선택해주세요. (미선택시 CPU에서 실행됨)");
				window.open(colab_path, "_blank");
			}			
		}else{
			alert("해당 실행환경은 구동이 불가능합니다. Binder와 Google Colab 중 한가지를 선택해주세요.");
		}
	}

    function code_listener() {
	var input_area = document.getElementsByClassName("input_area");

	for(var i = 0 ; i < input_area.length; i++){
		input_area[i].onclick = function(){
			run_exec();
    		}
	}

    } 

    code_listener();
</script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/bigdata-lecture/"></data>

  <div class="wrapper">
      <div class="footer-col">
	<footer-elem class=px-2>
		<a href="https://github.com/gusdnd852">
			<svg class="social svg-icon">
				<use xlink:href="/bigdata-lecture/assets/minima-social-icons.svg#github"></use>
			</svg>
			<span class="username">Github</span>
		</a>
	</footer-elem>

	<footer-elem class=px-2>
		<a href="https://youtube.com/channel/UCb7DJAuj1LulbY8WEr2EDUw">
			<svg class="social svg-icon">
				<use xlink:href="/bigdata-lecture/assets/minima-social-icons.svg#youtube"></use>
			</svg>
			<span class="username">Youtube</span>
		</a>
	</footer-elem>

	<footer-elem class=px-2>
		<a href="https://www.facebook.com/gusdnd852">
			<svg class="social svg-icon">
				<use xlink:href="/bigdata-lecture/assets/minima-social-icons.svg#facebook"></use>
			</svg>
			<span class="username">Facebook</span>
		</a>
	</footer-elem>
	<br>
	<div class="copyright">
		© Copyright 2020 Hyunwoong Go. All rights reserved.
	</div>
      </div>
  </div>
</footer>
</body>
</html>

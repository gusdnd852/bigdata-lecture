<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" type="image/x-icon" href="/bigdata-lecture/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>나이브 베이즈 알고리즘 | TensorFlow로 시작하는 머신러닝 &amp; 딥러닝</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="나이브 베이즈 알고리즘" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="확률기반 모델인 나이브베이즈 알고리즘을 배워보고 실습을 진행해봅시다." />
<meta property="og:description" content="확률기반 모델인 나이브베이즈 알고리즘을 배워보고 실습을 진행해봅시다." />
<link rel="canonical" href="https://gusdnd852.github.io/bigdata-lecture/naive_bayes" />
<meta property="og:url" content="https://gusdnd852.github.io/bigdata-lecture/naive_bayes" />
<meta property="og:site_name" content="TensorFlow로 시작하는 머신러닝 &amp; 딥러닝" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-23T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://gusdnd852.github.io/bigdata-lecture/naive_bayes","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://gusdnd852.github.io/bigdata-lecture/naive_bayes"},"headline":"나이브 베이즈 알고리즘","dateModified":"2020-07-23T00:00:00-05:00","datePublished":"2020-07-23T00:00:00-05:00","description":"확률기반 모델인 나이브베이즈 알고리즘을 배워보고 실습을 진행해봅시다.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
  <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css">
    <link rel="stylesheet" href="/bigdata-lecture/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://gusdnd852.github.io/bigdata-lecture/feed.xml" title="TensorFlow로 시작하는 머신러닝 & 딥러닝" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
          ]}
        );
      });
    </script>
  

  <script>
  function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
  }
  window.onload = wrap_img;
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function(){
      // add link icon to anchor tags
      var elem = document.querySelectorAll(".anchor-link")
      elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
      // remove paragraph tags in rendered toc (happens from notebooks)
      var toctags = document.querySelectorAll(".toc-entry")
      toctags.forEach(e => (e.firstElementChild.innerText = e.firstElementChild.innerText.replace('¶', '')))
    });
  </script>
</head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>

     @media screen and (max-width : 511px) {
         body { 
		font-size: 0.84rem; 
	}pre, code, blockquote {
		font-size: 0.84rem !important;
	}
	.katex, .mord {
		font: normal 1.02em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.90em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 0.9rem !important;
	}
	.contents-left{
		display: none !important;
	}
	.contents-right, .contents-left {
    		display: block;
    		text-align: center;
		margin-left: 0px !important;
    		margin-right: 0px !important;
    		list-style: none;
    	}
	.mobile_hide{
		display: none;
	}
	.contents-right > li {
    		display: inline-block;
    		margin: 3px;
    		word-break: keep-all;
	}
     }
 

     @media screen and (min-width : 512px) and (max-width : 767px) {
         body { 
		font-size: 0.92rem; 
	}pre, code, blockquote {
		font-size: 0.92rem !important;
	}
	.katex, .mord {
		font: normal 1.04em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.92em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 1.0rem !important;
	}
	.contents-left{
		display: none !important;
	}
	.contents-right, .contents-left {
    		display: block;
    		text-align: center;
		margin-left: 0px !important;
    		margin-right: 0px !important;
    		list-style: none;
    	}    
	.mobile_hide{
		display: none !important;
	}
	.contents-right > li {
    		display: inline-block;
    		margin: 3px;
    		word-break: keep-all;
	}
     }
 
     @media screen and (min-width : 768px) and (max-width : 1024px) {
         body {
		 font-size: 1.0rem; 
	}pre, code, blockquote {
		font-size: 1.0rem !important;
	}
	.katex, .mord {
		font: normal 1.05em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.93em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 1.1rem !important;
	}
	.contents-right, .contents-left {
		display: inline-block;
    		vertical-align: top;
    		text-align: left;
		list-style: none;
    	}  
	.contents-left{
		margin-left: 20px !important;
    		margin-right: 3.0rem;
	}
	.mobile_hide{
		display: block !important;
	}
     }

     @media screen and (min-width : 1025px) {
         body { 
		font-size: 1.08rem; 
	}pre, code, blockquote {
		font-size: 1.08rem !important;
	}
     	.katex, .mord {
		font: normal 1.06em 'KaTeX_Main', sans-serif !important;
	}
	.minner, .mord.mtight {
		font: normal 0.94em 'KaTeX_Main', sans-serif !important;
	}
	.page-meta {
		font-size: 1.2rem !important;
	}
	.contents-right, .contents-left {
    		display: inline-block;
    		vertical-align: top;
    		text-align: left;
		list-style: none;
    	}
	.contents-right > h2, .contents-left > h2 {
    		margin-botton: 2px
	}  
	.contents-left{
    		margin-left: 0 !important;
    		margin-right: 3.0rem;
	}
	.mobile_hide{
		display: block !important;
	}
     }

    </style>
  <body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" style="font-size:1.2rem;" href="/bigdata-lecture/">TensorFlow로 시작하는 머신러닝 &amp; 딥러닝 </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/bigdata-lecture/lecture">Lecture</a><a class="page-link" href="/bigdata-lecture/orientation">Orientation</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content" style="flex: none;" >
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h3 class="post-title p-name" itemprop="name headline">04. 나이브 베이즈 알고리즘</h3><p class="page-description">확률기반 모델인 나이브베이즈 알고리즘을 배워보고 실습을 진행해봅시다.</p
      <i class="fas fa-tags category-tags-icon"></i><p class="category-tags"> 
      
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
	
	<div class="px-1">
    <a href="https://colab.research.google.com/github/gusdnd852/bigdata-lecture/blob/master/_notebooks/04_04_나이브_베이즈.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/bigdata-lecture/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
	
	<div class="px-1">
<a href="https://github.com/gusdnd852/bigdata-lecture/tree/master/_notebooks/04_04_나이브_베이즈.ipynb" role="button">
    <img class="notebook-badge-image" src="https://img.shields.io/static/v1?label=&message=View%20On%20GitHub&color=586069&logo=github&labelColor=2f363d">
</a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#1.-나이브-베이즈-알고리즘이란?">1. 나이브 베이즈 알고리즘이란? </a></li>
<li class="toc-entry toc-h3"><a href="#2.-수식-풀이">2. 수식 풀이 </a></li>
<li class="toc-entry toc-h3"><a href="#3.-나이브-베이즈-알고리즘-예제">3. 나이브 베이즈 알고리즘 예제 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#3.1.-데이터에-대한-설명">3.1. 데이터에 대한 설명 </a></li>
<li class="toc-entry toc-h4"><a href="#3.2.-데이터-로딩">3.2. 데이터 로딩 </a></li>
<li class="toc-entry toc-h4"><a href="#3.3.-데이터-전처리">3.3. 데이터 전처리 </a></li>
<li class="toc-entry toc-h4"><a href="#3.4-모델-학습하기">3.4 모델 학습하기 </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#4.-나이브-베이즈-알고리즘-장점">4. 나이브 베이즈 알고리즘 장점 </a></li>
<li class="toc-entry toc-h3"><a href="#5.-나이브-베이즈-알고리즘-단점">5. 나이브 베이즈 알고리즘 단점 </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/04_04_나이브_베이즈.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br><br></p>
<h3 id="1.-나이브-베이즈-알고리즘이란?">
<a class="anchor" href="#1.-%EB%82%98%EC%9D%B4%EB%B8%8C-%EB%B2%A0%EC%9D%B4%EC%A6%88-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98%EC%9D%B4%EB%9E%80?" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. 나이브 베이즈 알고리즘이란?<a class="anchor-link" href="#1.-%EB%82%98%EC%9D%B4%EB%B8%8C-%EB%B2%A0%EC%9D%B4%EC%A6%88-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98%EC%9D%B4%EB%9E%80?"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://github.com/gusdnd852/bigdata-lecture/blob/master/_notebooks/img/Day2/92.jpg?raw=true" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>이번에 알려드릴 나이브 베이즈(Naive Bayes) 알고리즘은 분류 기법에서 사용되는 알고리즘 중 하나입니다. '나이브 베이즈'는 '순진하다'의 의미를 갖는 'naive'와 앞에서 학습한 '베이즈 정리'의 '베이즈'가 합쳐진 단어입니다. 그렇다면 왜 순진하다고 불릴까요? 나이브 베이즈 알고리즘은 데이터들이 서로 영향을 미치지 않는 동등하고 <strong>독립적인 데이터라고 가정</strong>하기 때문입니다.</p>
<p><br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://www.reviewjournal.com/wp-content/uploads/2019/04/12067517_web1_web_megabucks_sunsetstation.jpg" alt=""></p>
<p>예시를 하나 들어보겠습니다. 만약 여러분이 라스베가스에 갔다고 해봅시다. 이 때, 라스베가스에서 <strong>녹색 옷을 입고 잭팟이 터질 확률</strong>이 얼마나 될까요? 사실 일반적인 경우, 두 사건은 관련이 거의 없다고 말 할 수 있습니다. 따라서 <strong>녹색티셔츠를 입고 잭팟이 터질 확률과 그냥 아무 옷이나 입고 갔을 때 잭팟이 터질 확률이나 거의 비슷</strong>하다고 할 수 있습니다.
<br><br></p>
<p>이런 것을 사건의 독립이라고 합니다. 두 사건이 연관이 없는 것이죠. 그러나 실세계에서는 많은 요소들이 독립적이지 않습니다. 오히려 실세계에서는 대부분의 사건들이 종속적이죠. 모든 사건들이 종속적이라면 모든 곱확률(교집합)을 구해줘야 하기 때문에 계산하기 너무 힘들어집니다. 따라서 어느정도 <strong>정확한 확률을 포기하더라도 계산의 편리함을 위해 모든 사건을 그냥 독립적이라고 가정하고 문제를 푸는 것입니다.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h3 id="2.-수식-풀이">
<a class="anchor" href="#2.-%EC%88%98%EC%8B%9D-%ED%92%80%EC%9D%B4" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. 수식 풀이<a class="anchor-link" href="#2.-%EC%88%98%EC%8B%9D-%ED%92%80%EC%9D%B4"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>간단한 수식을 통해 확인해보겠습니다. 만약 두 사건 A와 B가 독립일 경우, 다음과 같이 작성할 수 있습니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br>

$$P(X \cap Y) = P(X)P(Y)$$

<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>그리고 베이즈 정리는 다음과 같습니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br>

$$P(X|Z) = \frac{P(Z|X)P(X)}{P(Z)} $$

<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>이 때, 위 식에 있는 사건 $Z$를 임의의 $A \cap B$라고 놓고 생각하면 아래의 식처럼 생각 할 수 있습니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br>

$$P(X|A \cap B) = \frac{P(A \cap B|X)P(X)}{P(A \cap B)} $$

<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>데이터를 독립으로 바라보는 나이브 베이즈 알고리즘에서는 <strong>$P(A \cap B|X)$</strong> 와 <strong>$P(A \cap B)$</strong>가 같기 때문에,  변경해줄 수 있습니다. 각 식을 변경해주면 다음과 같습니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br>

$$P(A \cap B|X) = P(A|X)P(B|X)$$

<br>

$$P(A \cap B) = P(A)P(B)$$

<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>변경된 식을 원래의 베이즈 정리에 대입하면 다음과 같은 결과가 도출되는 것을 확인 할 수 있습니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br>

$$P(X|A \cap B) = \frac{P(A|X)P(B|X)P(X)}{P(A)P(B)} $$

<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<p>교집합으로 구해야하는 부분이 모두 사라지기 때문에 매우 편리하게 계산할 수 있습니다. 지금은 사건이 $A$와 $B$ 두개 뿐이지만, 만약 사건이 $A$, $B$, $C$ ... 와 같이 많아진다면 $A \cap B$, $A \cap C$, $B \cap C$ 등을 다 구해야합니다. 나이브 베이즈 알고리즘은 이와 같은 식을 바탕으로 스팸 메일 분류, 텍스트 분류, 감정 분석, 추천 시스템 등 다양하게 활용되고 있습니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h3 id="3.-나이브-베이즈-알고리즘-예제">
<a class="anchor" href="#3.-%EB%82%98%EC%9D%B4%EB%B8%8C-%EB%B2%A0%EC%9D%B4%EC%A6%88-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98-%EC%98%88%EC%A0%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. 나이브 베이즈 알고리즘 예제<a class="anchor-link" href="#3.-%EB%82%98%EC%9D%B4%EB%B8%8C-%EB%B2%A0%EC%9D%B4%EC%A6%88-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98-%EC%98%88%EC%A0%9C"> </a>
</h3>
<p><img src="https://github.com/gusdnd852/bigdata-lecture/blob/master/_notebooks/img/Day4/spam.jpg?raw=true" alt=""></p>
<p>나이브 베이즈를 이용해 스펨메일을 필터링 해봅시다. 나이브 베이즈 알고리즘과 함께 여러가지 자연어 처리 기법들을 배워봅시다. 아래 링크에서 데이터를 다운로드 받아서 sample_data 폴더에 넣어주세요.
<br><br></p>
<p><a href="https://github.com/gusdnd852/bigdata-lecture/files/4970108/spam.zip">https://github.com/gusdnd852/bigdata-lecture/files/4970108/spam.zip</a></p>

<pre><code>root경로
    |_...
    |_sample_data
        |_spam.csv</code></pre>
<p><br></p>
<h4 id="3.1.-데이터에-대한-설명">
<a class="anchor" href="#3.1.-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%97%90-%EB%8C%80%ED%95%9C-%EC%84%A4%EB%AA%85" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.1. 데이터에 대한 설명<a class="anchor-link" href="#3.1.-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%97%90-%EB%8C%80%ED%95%9C-%EC%84%A4%EB%AA%85"> </a>
</h4>
<p>이메일의 내용을 갖고서 스팸인지 또는 햄(스팸이 아닌 이메일)인지 분류하는 데이터는 다음과 같은 예제를 갖고 있습니다.</p>
<table>
<thead>
<tr>
<th style="text-align:left">Class</th>
<th style="text-align:left">Text</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Spam</td>
<td style="text-align:left">free message</td>
</tr>
<tr>
<td style="text-align:left">Ham</td>
<td style="text-align:left">send me a messsage</td>
</tr>
<tr>
<td style="text-align:left">Ham</td>
<td style="text-align:left">are you free tomorrow?</td>
</tr>
<tr>
<td style="text-align:left">Spam</td>
<td style="text-align:left">where is tesseract?</td>
</tr>
<tr>
<td style="text-align:left">Ham</td>
<td style="text-align:left">where are you now?</td>
</tr>
<tr>
<td style="text-align:left">Spam</td>
<td style="text-align:left">buy awesome tv</td>
</tr>
</tbody>
</table>
<p><br>
예를 들어, <code>I cooked a salmon</code> 이런 문장인 경우 나이브 베이즈 알고리즘을 사용해서 Spam인지 또는 Ham인지 확률을 알아내는 것이 목표입니다. 베이즈 정리의 문제는 주어지는 데이터의 종속적 관계 때문에 연상량이 급격하게 늘어나게 됩니다. 예를 들어 이메일속의 단어들의 순서는 다른 단어가 나타날 확률을 의미할 수 있으며, 이는 각각의 단어가 다른 단어에 종속적임을 의미하게 됩니다. 예를 들어서 "카지노" 라는 단어가 나오면 그에 따라서 도박과 관련된 단어가 나올 확률이 높을 것 입니다. <br><br></p>
<p>나이브 베이즈는 이러한 현실적인 가정을 무시하고 모든 단어(또는 features)가 모두 <strong>독립적(Independent)이라고 가정</strong>을 합니다.물론 현실적으로 맞지는 않지만, 그럼에도 불구하고 이러한 가정은 계산량은 줄여주면서 잘 작동합니다. <br><br></p>
<p>많은 통계학자들이 가정 자체가 틀렸는데 왜 이렇게 잘 작동하는지 많은 연구를 하였는데.. 그중 하나의 설명이 좀 개인적으로 와닿았습니다. 만약 스팸을 정확하게 모두 걸러낸다면 신뢰구간 51% ~ 99%가 의미가 있는 것인가 입니다. 즉 test하면 대부분의 spam을 잘 맞추는데, 확률론적으로 매우 정확한 계산을 해내는 것 자체가 크게 중요하지 않다는 의미입니다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h4 id="3.2.-데이터-로딩">
<a class="anchor" href="#3.2.-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%A1%9C%EB%94%A9" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2. 데이터 로딩<a class="anchor-link" href="#3.2.-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%A1%9C%EB%94%A9"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">pylab</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">string</span>

<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># 필요한 라이브러리 모두 import</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Populating the interactive namespace from numpy and matplotlib
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'sample_data/spam.csv'</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'class'</span><span class="p">,</span> <span class="s1">'text'</span><span class="p">]</span>

<span class="n">dataset</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ham</td>
      <td>Go until jurong point, crazy.. Available only ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ham</td>
      <td>Ok lar... Joking wif u oni...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>spam</td>
      <td>Free entry in 2 a wkly comp to win FA Cup fina...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ham</td>
      <td>U dun say so early hor... U c already then say...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ham</td>
      <td>Nah I don't think he goes to usf, he lives aro...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5567</th>
      <td>spam</td>
      <td>This is the 2nd time we have tried 2 contact u...</td>
    </tr>
    <tr>
      <th>5568</th>
      <td>ham</td>
      <td>Will ? b going to esplanade fr home?</td>
    </tr>
    <tr>
      <th>5569</th>
      <td>ham</td>
      <td>Pity, * was in mood for that. So...any other s...</td>
    </tr>
    <tr>
      <th>5570</th>
      <td>ham</td>
      <td>The guy did some bitching but I acted like i'd...</td>
    </tr>
    <tr>
      <th>5571</th>
      <td>ham</td>
      <td>Rofl. Its true to its name</td>
    </tr>
  </tbody>
</table>
<p>5572 rows × 2 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h4 id="3.3.-데이터-전처리">
<a class="anchor" href="#3.3.-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3. 데이터 전처리<a class="anchor-link" href="#3.3.-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'class'</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">text</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>class</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ham</th>
      <td>4825</td>
      <td>4516</td>
      <td>Sorry, I'll call later</td>
      <td>30</td>
    </tr>
    <tr>
      <th>spam</th>
      <td>747</td>
      <td>653</td>
      <td>Please call our customer service representativ...</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>약 13.5% 만이 spam으로 분류되어 있습니다. 즉 class imbalance(불균형) 문제가 있는 데이터 셋입니다. unique 메세지를 보면 duplicate text가 존재함을 알 수 있습니다. (총 4825개인데 4516개의 unique값이 존재함)
<br><br></p>
<p>또한 아래의 histogram에서 알 수 있듯이, 대부분의 Ham의 글자길이는 대부분 100이하에 있고, Spam의 경우는 150쯤에 있습니다. 즉 길이의 차이가 있으며, Spam이 문장의 길이가 더 깁니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="s1">'length'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">'text'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="s1">'length'</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">'class'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA44AAAF8CAYAAACAMuWvAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAgAElEQVR4nO3de7SlZ10f8O+PDEbuEJjEkEmYqNNoQEUYA9VaqTGSGheJroWGqgSNTbVRsLWVibqKdnXaoa0XrI1t5BYrGAJeMorcjEWWCoQBuSUhJpCBDAnJIBfx0kjCr3/sPcnJ4cw755x9zt77nPP5rMU6ez/v++79Ow858+7vfp73eau7AwAAAEfzoFkXAAAAwHwTHAEAABgkOAIAADBIcAQAAGCQ4AgAAMAgwREAAIBBgiOsk6o6WFXfNus6AABgUoIjAAAAgwRHAAAABgmOsL6eXFXvr6rPVtVrqupLq+oxVfUHVXW4qj49frzjyAFV9daq+k9V9edV9TdV9ftV9diqelVV/XVVvauqds7uVwKAjaeqXlhVH6+qz1XVTVV1dlX9XFW9bnyO/lxVvaeqvm7BMXuq6sPjbTdU1Xct2Pa8qvqzqvqlqvpMVX2kqr5x3H5bVd1VVRfN5reFtSc4wvr6niTnJjk9ydcmeV5Gf3evSPKEJKcl+fskv7rouAuT/ECSU5J8RZK3j485IcmNSV60/qUDwOZQVWck+bEk39Ddj0jyzCQHx5vPT/LajM6xr07ye1X14PG2Dyf55iSPSvLzSX6zqk5e8NJPS/L+JI8dH3tVkm9I8pVJvj/Jr1bVw9fvN4PpERxhff1Kd9/e3Z9K8vtJntzdf9Xdv93df9fdn0uyN8m3LDruFd394e7+bJI3JPlwd/9Rd9+T0cnt66f6WwDAxnZvkuOTnFlVD+7ug9394fG2d3f367r780l+McmXJnl6knT3a8fn8S9092uS3JzkrAWve2t3v6K7703ymiSnJvmP3X13d785yT9kFCJhwxMcYX19YsHjv0vy8Kp6aFX976r6aFX9dZK3JXl0VR23YN87Fzz++yWe+/YSAJapu29J8hNJfi7JXVV1VVU9frz5tgX7fSHJoSSPT5Kqem5VvXc8FfUzSZ6U5HELXnrx+Tnd7ZzNpiQ4wvT9ZJIzkjytux+Z5J+O22t2JQHA5tbdr+7uf5LRpSKd5MXjTace2aeqHpRkR5Lbq+oJSX49oymuj+3uRyf5YJyv2aIER5i+R2T0DeRnquqEuF4RANZVVZ1RVd9aVccn+X8ZnYfvHW9+alV9d1Vty2hU8u4k70jysIwC5uHxa/xgRiOOsCUJjjB9v5zkIUk+mdGJ6Y2zLQcANr3jk+zL6Nz7iSQnJvnp8bZrknxvkk9ntDDdd3f357v7hiS/kNECdXcm+ZokfzblumFuVHfPugYAAJi6qvq5JF/Z3d8/61pg3hlxBAAAYJDgCAAAwCBTVQEAABhkxBEAAIBBgiMAAACDts26gGN53OMe1zt37px1GQCsoXe/+92f7O7ts66D1XN+BticjnaOnvvguHPnzhw4cGDWZQCwhqrqo7Ougck4PwNsTkc7R5uqCgAAwCDBEQAAgEGCIwAAAIMERwAAAAYJjgAAAAwSHAEAABgkOAIAADBIcAQAAGCQ4AgAAMAgwREAAIBBgiMAAACDBEcAAAAGCY4AAAAM2jbrAmZt557XL9l+cN95U64EAADmw9E+Iyc+J29VRhwBYJOpqpdX1V1V9cEltv27quqqetyCtsuq6paquqmqnjndagHYCARHANh8Xpnk3MWNVXVqknOSfGxB25lJLkzyxPExl1fVcdMpE4CNQnAEgE2mu9+W5FNLbPqlJD+VpBe0nZ/kqu6+u7tvTXJLkrPWv0oANhLBEQC2gKp6VpKPd/f7Fm06JcltC54fGrct9RqXVNWBqjpw+PDhdaoUgHkkOALAJldVD03yM0n+w1Kbl2jrJdrS3Vd09+7u3r19+/a1LBGAObflV1UFgC3gK5KcnuR9VZUkO5K8p6rOymiE8dQF++5IcvvUKwRgrhlxBIBNrrs/0N0ndvfO7t6ZUVh8Snd/Isn+JBdW1fFVdXqSXUmum2G5AMwhwREANpmq+q0kb09yRlUdqqqLj7Zvd1+f5OokNyR5Y5JLu/ve6VQKwEZxzOC4VveCqqqnVtUHxtt+pcZzZQCAtdXdz+nuk7v7wd29o7tftmj7zu7+5ILne7v7K7r7jO5+w/QrBmDeLWfE8ZVZm3tB/VqSSzKaArNrqdcEAABg/hwzOK7FvaCq6uQkj+zut3d3J/mNJBdMXD0AAADrblXXOK7iXlCnjB8vbgcAAGDOrfh2HAvuBfXtS21eoq0H2o/2HpdkNK01p5122kpLBAAAYA2tZsRx4b2gDub+e0F9WY5+L6hD48eL25fkBsMAAADzY8XBcTX3guruO5J8rqqePl5N9blJrlm7XwMAAID1spzbcazVvaB+NMlLM1ow58NJLPcNAACwARzzGsfufs4xtu9c9Hxvkr1L7HcgyZNWWB8AAAAztqpVVQEAANg6BEcAAAAGCY4AAAAMEhwBAAAYJDgCAAAwSHAEAABgkOAIAADAIMERAACAQYIjAAAAgwRHAAAABgmOAAAADBIcAQAAGCQ4AgAAMEhwBAAAYJDgCAAAwCDBEQAAgEGCIwAAAIMERwAAAAYJjgAAAAwSHAEAABgkOAIAADBIcAQAAGCQ4AgAAMAgwREAAIBBgiMAAACDBEcAAAAGCY4AsMlU1cur6q6q+uCCtv9WVR+qqvdX1e9W1aMXbLusqm6pqpuq6pmzqRqAeSY4AsDm88ok5y5qe0uSJ3X31yb5yySXJUlVnZnkwiRPHB9zeVUdN71SAdgIBEcA2GS6+21JPrWo7c3dfc/46TuS7Bg/Pj/JVd19d3ffmuSWJGdNrVgANgTBEQC2nh9K8obx41OS3LZg26FxGwDcR3AEgC2kqn4myT1JXnWkaYnd+ijHXlJVB6rqwOHDh9erRADmkOAIAFtEVV2U5DuTfF93HwmHh5KcumC3HUluX+r47r6iu3d39+7t27evb7EAzBXBEQC2gKo6N8kLkzyru/9uwab9SS6squOr6vQku5JcN4saAZhfxwyOa7Wkd1U9tao+MN72K1W11NQYAGBCVfVbSd6e5IyqOlRVFyf51SSPSPKWqnpvVf2vJOnu65NcneSGJG9Mcml33zuj0gGYU8sZcXxl1mZJ719LcklG32TuWuI1AYA10N3P6e6Tu/vB3b2ju1/W3V/Z3ad295PH//uRBfvv7e6v6O4zuvsNQ68NwNZ0zOC4Fkt6V9XJSR7Z3W8fX1PxG0kuWKtfAgAAgPWzFtc4LmdJ71PGjxe3AwAAMOcmCo4rWNJ72Ut9j1/Xct8AAABzYtXBcYVLeh/K/dNZF7YvyXLfAAAA82NVwXGlS3p39x1JPldVTx+vpvrcJNdMWDsAAABTsO1YO4yX9H5GksdV1aEkL8poFdXjM1rSO0ne0d0/0t3XV9WRJb3vyQOX9P7RjFZofUhG10RatQ0AAGADOGZw7O7nLNH8soH99ybZu0T7gSRPWlF1AAAAzNxarKoKAADAJiY4AgAAMEhwBAAAYJDgCAAAwCDBEQAAgEGCIwAAAIMERwAAAAYJjgAAAAwSHAEAABgkOAIAADBIcAQAAGCQ4AgAAMAgwREAAIBBgiMAAACDBEcAAAAGCY4AAAAMEhwBAAAYJDgCAAAwaNusCwAAAGZj557Xz7oENggjjgAAAAwSHAEAABgkOAIAADBIcAQAAGCQ4AgAAMAgwREAAIBBgiMAAACDBEcAAAAGCY4AAAAMEhwBYJOpqpdX1V1V9cEFbSdU1Vuq6ubxz8cs2HZZVd1SVTdV1TNnUzUA80xwBIDN55VJzl3UtifJtd29K8m14+epqjOTXJjkieNjLq+q46ZXKgAbgeAIAJtMd78tyacWNZ+f5Mrx4yuTXLCg/aruvru7b01yS5KzplIoABuG4AgAW8NJ3X1Hkox/njhuPyXJbQv2OzRu+yJVdUlVHaiqA4cPH17XYgGYL4IjAGxttURbL7Vjd1/R3bu7e/f27dvXuSwA5ongCABbw51VdXKSjH/eNW4/lOTUBfvtSHL7lGsDYM4dMziu1cpsVfXUqvrAeNuvVNVS33ACAOtjf5KLxo8vSnLNgvYLq+r4qjo9ya4k182gPgDm2HJGHF+ZtVmZ7deSXJLRCWnXEq8JAKyBqvqtJG9PckZVHaqqi5PsS3JOVd2c5Jzx83T39UmuTnJDkjcmubS7751N5QDMq23H2qG731ZVOxc1n5/kGePHVyZ5a5IXZsHKbElurapbkpxVVQeTPLK7354kVfUbGa3m9oaJfwMA4AG6+zlH2XT2Ufbfm2Tv+lUEwEa32mscV7oy2ynjx4vbl2TVNgAAgPmx1ovjHG1ltmWv2JZYtQ0AAGCerDY4rnRltkPjx4vbAQAAmHPHvMbxKI6szLYvX7wy26ur6heTPD7jldm6+96q+lxVPT3JO5M8N8n/mKjydbZzz+uPuu3gvvOmWAkAAMBsHTM4jldme0aSx1XVoSQvyigwXj1epe1jSZ6djFZmq6ojK7PdkweuzPajGa3Q+pCMFsWxMA4AAMAGsJxVVddkZbbuPpDkSSuqDgAAgJlb68VxAAAA2GQERwAAAAYJjgAAAAwSHAEAABgkOAIAADBIcAQAAGCQ4AgAAMAgwREAAIBBgiMAAACDBEcAAAAGCY4AAAAMEhwBAAAYJDgCAAAwSHAEAABgkOAIAADAIMERAACAQYIjAAAAgwRHAAAABgmOAAAADBIcAQAAGCQ4AgAAMEhwBAAAYJDgCAAAwCDBEQAAgEGCIwAAAIMERwAAAAYJjgAAAAwSHAEAABgkOALAFlJV/6aqrq+qD1bVb1XVl1bVCVX1lqq6efzzMbOuE4D5IjgCwBZRVackeX6S3d39pCTHJbkwyZ4k13b3riTXjp8DwH0ERwDYWrYleUhVbUvy0CS3Jzk/yZXj7VcmuWBGtQEwpwRHANgiuvvjSf57ko8luSPJZ7v7zUlO6u47xvvckeTE2VUJwDwSHAFgixhfu3h+ktOTPD7Jw6rq+1dw/CVVdaCqDhw+fHi9ygRgDk0UHFd6gX1VXVZVt1TVTVX1zMnLBwBW4NuS3Nrdh7v780l+J8k3Jrmzqk5OkvHPu5Y6uLuv6O7d3b17+/btUysagNlbdXBc6QX2VXXmePsTk5yb5PKqOm6y8gGAFfhYkqdX1UOrqpKcneTGJPuTXDTe56Ik18yoPgDm1KRTVVdygf35Sa7q7ru7+9YktyQ5a8L3BwCWqbvfmeR1Sd6T5AMZfQ64Ism+JOdU1c1Jzhk/B4D7bFvtgd398ao6coH93yd5c3e/uaoecIF9VR25wP6UJO9Y8BKHxm1fpKouSXJJkpx22mmrLREAWKS7X5TkRYua785o9BEAljTJVNWVXmBfS7T1Uju6hgIAAGB+TDJVdaUX2B9KcuqC43dkNLUVAACAOTZJcFzpBfb7k1xYVcdX1elJdiW5boL3BwAAYAomucbxnVV15AL7e5L8RUYX2D88ydVVdXFG4fLZ4/2vr6qrk9ww3v/S7r53wvoBAABYZ6sOjsnKL7Dv7r1J9k7yngAAAEzXpLfjAAAAYJMTHAEAABgkOAIAADBIcAQAAGCQ4AgAAMAgwREAAIBBgiMAAACDBEcAAAAGCY4AAAAM2jbrAgAAgI1j557XH3XbwX3nTbESpsmIIwAAAIMERwAAAAYJjgAAAAwSHAEAABgkOAIAADBIcAQAAGCQ4AgAAMAgwREAAIBBgiMAAACDBEcAAAAGCY4AAAAMEhwBAAAYJDgCAAAwSHAEAABgkOAIAADAIMERAACAQYIjAAAAgwRHAAAABgmOAAAADBIcAQAAGCQ4AsAWUlWPrqrXVdWHqurGqvrHVXVCVb2lqm4e/3zMrOsEYL4IjgCwtbwkyRu7+6uSfF2SG5PsSXJtd+9Kcu34OQDcR3AEgC2iqh6Z5J8meVmSdPc/dPdnkpyf5MrxblcmuWA2FQIwr7ZNcnBVPTrJS5M8KUkn+aEkNyV5TZKdSQ4m+Z7u/vR4/8uSXJzk3iTP7+43TfL+AMCKfHmSw0leUVVfl+TdSV6Q5KTuviNJuvuOqjpxqYOr6pIklyTJaaedNp2KgWXZuef1R912cN95U6yEzWrSEcdlT3epqjOTXJjkiUnOTXJ5VR034fsDAMu3LclTkvxad399kr/NCqaldvcV3b27u3dv3759vWoEYA6tOjiuYrrL+Umu6u67u/vWJLckOWu17w8ArNihJIe6+53j56/LKEjeWVUnJ8n4510zqg+AOTXJiOPC6S5/UVUvraqHZdF0lyRHpruckuS2BccfGrcBAFPQ3Z9IcltVnTFuOjvJDUn2J7lo3HZRkmtmUB4Ac2ySaxyPTHf58e5+Z1W9JMPTXWqJtl5yR9dQAMB6+fEkr6qqL0nykSQ/mNEXyVdX1cVJPpbk2TOsD4A5NElwXGq6y56Mp7uML65fON3lUJJTFxy/I8ntS71wd1+R5Iok2b1795LhEgBYue5+b5LdS2w6e9q1ALBxrDo4dvcnquq2qjqju2/K/dNdbshomsu+PHC6y/4kr66qX0zy+CS7klw3SfGzYtUqAABgK5nodhxZwXSX7r6+qq7OKFjek+TS7r53wvcHAABgnU0UHFc63aW79ybZO8l7AgAAMF2T3scRAACATU5wBAAAYJDgCAAAwCDBEQAAgEGCIwAAAIMERwAAAAYJjgAAAAwSHAEAABgkOAIAADBIcAQAAGCQ4AgAAMAgwREAAIBBgiMAAACDBEcAAAAGCY4AAAAM2jbrAgAAgPWzc8/rZ10Cm4ARRwAAAAYJjgAAAAwSHAEAABgkOAIAADDI4jgAALABWOSGWTLiCAAAwCDBEQAAgEGCIwAAAINc4wgAAHPCdYzMKyOOAAAADBIcAQAAGCQ4AgAAMEhwBAAAYJDgCAAAwCCrqq6xoZWwDu47b4qVAAAArA0jjgCwxVTVcVX1F1X1B+PnJ1TVW6rq5vHPx8y6RgDmi+AIAFvPC5LcuOD5niTXdveuJNeOnwPAfQRHANhCqmpHkvOSvHRB8/lJrhw/vjLJBdOuC4D5NnFwXMl0l6q6rKpuqaqbquqZk743ALBiv5zkp5J8YUHbSd19R5KMf544i8IAmF9rMeK4rOkuVXVmkguTPDHJuUkur6rj1uD9AYBlqKrvTHJXd797lcdfUlUHqurA4cOH17g6AObZRMFxhdNdzk9yVXff3d23JrklyVmTvD8AsCLflORZVXUwyVVJvrWqfjPJnVV1cpKMf9611MHdfUV37+7u3du3b59WzQDMgUlHHFcy3eWUJLct2O/QuO2L+EYTANZed1/W3Tu6e2dGs4D+uLu/P8n+JBeNd7soyTUzKhGAObXq4LiK6S61RFsvtaNvNAFgqvYlOaeqbk5yzvg5ANxn2wTHHpnu8h1JvjTJIxdOd+nuOxZNdzmU5NQFx+9IcvsE7w8ArFJ3vzXJW8eP/yrJ2bOsB4D5tuoRx1VMd9mf5MKqOr6qTk+yK8l1q64cAACAqZhkxPFo9iW5uqouTvKxJM9Oku6+vqquTnJDknuSXNrd967D+wMAALCG1iQ4Lne6S3fvTbJ3Ld4TAACA6ViL+zgCAACwiQmOAAAADBIcAQAAGCQ4AgAAMEhwBAAAYJDgCAAAwCDBEQAAgEGCIwAAAIMERwAAAAYJjgAAAAwSHAEAABgkOAIAADBIcAQAAGCQ4AgAAMAgwREAAIBBgiMAAACDBEcAAAAGCY4AAAAMEhwBAAAYJDgCAAAwaNusCwAAgK1k557Xz7oEWDEjjgAAAAwy4riBDX1bdXDfeVOsBAAA2MyMOAIAADDIiOMUGSEEAAA2IsFxTgiVAADAvDJVFQAAgEGCIwAAAIMERwAAAAYJjgAAAAwSHAEAABgkOAIAADBIcASALaKqTq2q/1tVN1bV9VX1gnH7CVX1lqq6efzzMbOuFYD5sur7OFbVqUl+I8mXJflCkiu6+yVVdUKS1yTZmeRgku/p7k+Pj7ksycVJ7k3y/O5+00TVbxFD93gEgBW4J8lPdvd7quoRSd5dVW9J8rwk13b3vqrak2RPkhfOsE6YK+63DZONOB45+Xx1kqcnubSqzszoZHNtd+9Kcu34ecbbLkzyxCTnJrm8qo6bpHgAYPm6+47ufs/48eeS3JjklCTnJ7lyvNuVSS6YTYUAzKtVB8dVnHzOT3JVd9/d3bcmuSXJWat9fwBg9apqZ5KvT/LOJCd19x3J6Pye5MSjHHNJVR2oqgOHDx+eVqkAzIE1ucZxmSefU5LctuCwQ+O2pV7PiQkA1klVPTzJbyf5ie7+6+Ue191XdPfu7t69ffv29SsQgLkzcXBcwcmnlmjrpXZ0YgKA9VFVD87ovP2q7v6dcfOdVXXyePvJSe6aVX0AzKeJguMKTz6Hkpy64PAdSW6f5P0BgOWrqkrysiQ3dvcvLti0P8lF48cXJblm2rUBMN9WHRxXcfLZn+TCqjq+qk5PsivJdat9fwBgxb4pyQ8k+daqeu/4f9+RZF+Sc6rq5iTnjJ8DwH1WfTuO3H/y+UBVvXfc9tMZnWyurqqLk3wsybOTpLuvr6qrk9yQ0Yqsl3b3vRO8PwCwAt39p1n60pEkOXuatQCwsaw6OK7m5NPde5PsXe17AgAAMH1rsqoqAAAAm9ckU1U3jJ17Xj/rEgAAADasLREcAQBgPQwNUBzcd94UK4H1ZaoqAAAAg4w4AgDAOnC5FJuJEUcAAAAGGXEEAGDTcM0hrA8jjgAAAAwSHAEAABgkOAIAADBIcAQAAGCQxXEAAJhLFrqB+WHEEQAAgEFGHAEA2PKGRjcBI44AAAAcgxFHAAC2BKOKsHpGHAEAABhkxBEAYAuyYinrwX9Xm5cRRwAAAAYZcQQAWGPzMuqy1tf0zcvvBUyfEUcAAAAGGXEEAGDDsUIqTJcRRwAAAAYJjgAAAAwyVRUAgHVlUR3Y+ATHTco/0AAAwFoRHAEAmBmL3MDG4BpHAAAABhlxBAA2vdVewrERLv0wYsdGsZr/Vufl7wwjjgAAAByDEUcAACZm5JNp2wgzAjYTwXEL8kcGAACshOAIALAKqx1hO9px8/TlrdFDYLGpB8eqOjfJS5Icl+Sl3b1v2jWwOms9UmnkE2B+OD8DMGSqwbGqjkvyP5Ock+RQkndV1f7uvmGadXB0m/nbUwCW5vwMwLFMe8TxrCS3dPdHkqSqrkpyfhInpk1qrYNoIowCrIOZnJ/XYzrkWs+AmaZ5qQPmybT/LjbCZ9BZ1Tjt4HhKktsWPD+U5GlTroENzon1gTbCP2KrNS+/21pzUmIOOT8DMGjawbGWaOsv2qnqkiSXjJ/+TVXdNMF7Pi7JJyc4fivRV8s3N31VL551Bcuyqv7aIL/bmqoXz89/W0ezRv+/PGFNXoW1Movz87qY83835v7ve4PQj5Pb9H24Hv8WLHrNuezD9TxHTzs4Hkpy6oLnO5Lcvnin7r4iyRVr8YZVdaC7d6/Fa212+mr59NXK6K/l01fMyNTPz1uRv++1oR8npw8ntxX78EFTfr93JdlVVadX1ZckuTDJ/inXAAA8kPMzAIOmOuLY3fdU1Y8leVNGy32/vLuvn2YNAMADOT8DcCxTv49jd/9hkj+c4luaUrN8+mr59NXK6K/l01fMxAzOz1uRv++1oR8npw8nt+X6sLq/6Np3AAAAuM+0r3EEAABggxEcAQAAGCQ4AgAAMGjqi+Ost6r6qiTnJzklo5sX355kf3ffONPC5lBVVZKz8sC+uq5d+PpF9NXy6auV0V8AMP+crzfZ4jhV9cIkz0lyVUY3M05GNzG+MMlV3b1vVrXNm6r69iSXJ7k5ycfHzTuSfGWSf93db55VbfNGXy2fvloZ/QWbV1U9KsllSS5Isn3cfFeSa5Ls6+7PzKq2jcYH9snpw8k4X49stuD4l0me2N2fX9T+JUmu7+5ds6ls/lTVjUn+eXcfXNR+epI/7O6vnklhc0hfLZ++Whn9BZtXVb0pyR8nubK7PzFu+7IkFyX5tu4+Z5b1bRQ+sE9OH07O+Xpks01V/UKSxyf56KL2k8fbuN+23D8qu9DHkzx4yrXMO321fPpqZfQXbF47u/vFCxvGAfLFVfVDM6ppI3pJRkH74MLGIx/Yk2yJD+wT0oeTc77O5guOP5Hk2qq6Oclt47bTMvpG5cdmVtV8enmSd1XVVbm/r07NaFrvy2ZW1XzSV8unr1ZGf8Hm9dGq+qmMRhzvTJKqOinJ83L/3zvH5gP75PTh5Jyvs8mmqiZJVT0o98/hroz+UN7V3ffOtLA5VFVnJnlWHthX+7v7hpkWNof01fLpq5XRX7A5VdVjkuzJaMG+kzK6ruzOJPuTvLi7PzXD8jaMqrosyfdktH7F4g/sV3f3f5lVbRuFPlwbztebMDgCAMybqvrmjL7Y/oBrylbGB/bJVdVX5/67DuhDVkVw3KKs9rZ8+mr59NXK6C/YvKrquu4+a/z4h5NcmuT3knx7kt+30jtsHM7XIw+adQHMzNVJPp3kGd392O5+bJJ/luQzSV4708rmj75aPn21MvoLNq+F1479qyTf3t0/n1Fw/L7ZlLTxVNWjqmpfVX2oqv5q/L8bx22PnnV9G0FVnbvg8aOq6qVV9f6qevX4uluOzfk6Rhy3rKq6qbvPWOm2rUhfLZ++Whn9BZtXVb0vyTMy+pL+Td29e8G2v+jur59VbRvJwG1NnpfkbLc1Obaqek93P2X8+KVJPpHk15N8d5Jv6e4LZlnfRuB8PWLEcev6aFX91MJvmqrqpKp6Yaz2tpi+Wj59tTL6CzavRyV5d5IDSU4Yh51U1cMzusaM5dnZ3S8+EhqT0W1NxlN9T5thXRvV7u7+2e7+aHf/UpKdsy5og3C+juC4lX1vkscm+ZOq+nRVfSrJW5OckNHKW9xvcV99OqO+emz01WL+u1oZ/QWbVHfv7O4v7+7Txz+PBJ8vJPmuWda2wfjAPrkTq+rfVtVPJnlkVS384kIWWB7n65iquqVV1Vcl2ZHkHd39N+OXd8cAAAK3SURBVAvaz+3uN86usvlXVf+nu39g1nXMm6p6WpIPdfdnq+qhGS1F/5Qk1yf5z9392ZkWOGeq6kuSPCfJx7v7j6rq+5J8Y5IbklzR3Z+faYEAM7botiYnjpuP3NZkX3d/ela1bRRV9aJFTZd39+HxKPh/7e7nzqKujcbnZsFxy6qq52e0wtuNSZ6c5AXdfc14231z4Umqav8Szd+a0TUX6e5nTbei+VVV1yf5uu6+p6quSPK3SX47ydnj9u+eaYFzpqpeldGNmR+S5LNJHpbkdzPqr+rui2ZYHsBcq6of7O5XzLqOjUwfLo/PzSPbZl0AM/Mvkzy1u/+mqnYmeV1V7ezul8S1F4vtyGgE6KUZ3cC5knxDkl+YZVFz6kHdfc/48e4F/5D+aVW9d1ZFzbGv6e6vraptST6e5PHdfW9V/WaS9824NoB59/NJhJ7J6MPl8bk5guNWdtyRYfbuPlhVz8joj+AJ2UJ/AMu0O8kLkvxMkn/f3e+tqr/v7j+ZcV3z6IMLvr18X1Xt7u4DVfWPkph2+cUeNJ6u+rAkD81oMY1PJTk+D1zKH2BLqqr3H21TEreSWAZ9uCZ8bo7guJV9oqqe3N3vTZLxNyjfmeTlSb5mtqXNl+7+QpJfqqrXjn/eGX87R/PDSV5SVT+b5JNJ3l5Vt2W0gMEPz7Sy+fSyJB9KclxGX0y8tqo+kuTpSa6aZWEAc+KkJM/M6B56C1WSP59+ORuSPpycz81xjeOWVVU7ktyzcHnrBdu+qbv/bAZlbQhVdV6Sb+run551LfOqqh6R5MszCtiHuvvOGZc0t6rq8UnS3bePb2b9bUk+1t3XzbYygNmrqpcleUV3/+kS217d3f9iBmVtKPpwcj43jwiOAAAADHLvFgAAAAYJjgAAAAwSHAEAABgkOAIAADBIcAQAAGDQ/wccMr835zjOFQAAAABJRU5ErkJggg==%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>이제 데이터를 전처리합니다. 아래와 같은 과정을 거쳐서 데이터를 전처리할 계획입니다.
<br><br></p>
<ol>
<li>
<p>구두점, Stop Word 제거 : 구두점과 너무 자주 쓰이는 단어들(a, the, of, at 등)을 제거합니다. 이런 단어들(Stop Word)과 구두점들은 스팸이던 햄이던 상관없이 너무 자주 등장하기 때문에 오히려 분류에 방해가 됩니다.</p>
</li>
<li>
<p>Tokenizing : 단어를 띄어쓰기 기준으로 잘라서 리스트로 자릅니다. 단어들은 string이 아니라 list의 타입이 되고, 그 리스트에 단어들이 각각 들어가게 됩니다.</p>
</li>
<li>
<p>Word Encoding : 모든 단어를 숫자로 바꿔줍니다. 하나의 단어는 하나의 고유한 숫자가 됩니다. 컴퓨터는 자연어를 처리할 수 없기 때문에 숫자로 바꿔줘야합니다. (2주차 딥러닝 수업때는 더욱 진보된 워드 임베딩에 대해 배웁니다)</p>
</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>

<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">'stopwords'</span><span class="p">)</span> 
<span class="c1"># Stop Word 목록을 다운로드 받습니다.</span>


<span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    
    <span class="c1"># Remove Punctuations</span>
    <span class="n">nopunc</span> <span class="o">=</span> <span class="p">[</span><span class="n">char</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">text</span> <span class="k">if</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">]</span>
    <span class="n">nopunc</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nopunc</span><span class="p">)</span>
    
    <span class="c1"># Remove stopwords</span>
    <span class="n">cleaned_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">nopunc</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">'english'</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">cleaned_words</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[nltk_data] Downloading package stopwords to
[nltk_data]     C:\Users\ASUS\AppData\Roaming\nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 데이터가 많아서 시간이 조금 걸립니다.</span>

<span class="n">dataset</span><span class="p">[</span><span class="s1">'text'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">preprocess</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0       [Go, jurong, point, crazy, Available, bugis, n...
1                          [Ok, lar, Joking, wif, u, oni]
2       [Free, entry, 2, wkly, comp, win, FA, Cup, fin...
3           [U, dun, say, early, hor, U, c, already, say]
4       [Nah, dont, think, goes, usf, lives, around, t...
                              ...                        
5567    [2nd, time, tried, 2, contact, u, U, 傭50, Poun...
5568                      [b, going, esplanade, fr, home]
5569                     [Pity, mood, Soany, suggestions]
5570    [guy, bitching, acted, like, id, interested, b...
5571                                   [Rofl, true, name]
Name: text, Length: 5572, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h4 id="3.4-모델-학습하기">
<a class="anchor" href="#3.4-%EB%AA%A8%EB%8D%B8-%ED%95%99%EC%8A%B5%ED%95%98%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4 모델 학습하기<a class="anchor-link" href="#3.4-%EB%AA%A8%EB%8D%B8-%ED%95%99%EC%8A%B5%ED%95%98%EA%B8%B0"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>데이터를 학습/테스트 세트로 분할합니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">label</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">'class'</span><span class="p">]</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">'text'</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">split</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.8</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span> 

<span class="n">train_feature</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:</span><span class="n">split</span><span class="p">]</span>
<span class="n">train_label</span> <span class="o">=</span> <span class="n">label</span><span class="p">[:</span><span class="n">split</span><span class="p">]</span>

<span class="n">test_feature</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">split</span><span class="p">:]</span>
<span class="n">test_label</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="n">split</span><span class="p">:]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">train_feature</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">train_label</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_feature</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">test_label</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(4457,) (4457,)
(1115,) (1115,)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>이제 학습 파이프라인을 만듭니다. sklearn에서는 Pipeline이라는 클래스로 두 모델을 연결할 수 있습니다. 가장 먼저 <code>CounterVectorizer</code>를 이용해 단어를 숫자로 인코딩 한뒤, 인코딩된 숫자를 곧 바로 <code>NaiveBayes</code> 모델의 입력으로 넣어서 학습하는 파이프라인을 고안해볼 수 있습니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">'word_encoder'</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="n">preprocess</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">'classifier'</span><span class="p">,</span> <span class="n">MultinomialNB</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_feature</span><span class="p">,</span> <span class="n">train_label</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Pipeline(steps=[('word_encoder',
                 CountVectorizer(analyzer=&lt;function preprocess at 0x000001DB642E3598&gt;)),
                ('classifier', MultinomialNB())])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_feature</span><span class="p">)</span>
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">test_label</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.97847533632287</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">test_label</span><span class="p">,</span> <span class="n">pred</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

         ham       0.99      0.99      0.99       970
        spam       0.92      0.92      0.92       145

    accuracy                           0.98      1115
   macro avg       0.95      0.95      0.95      1115
weighted avg       0.98      0.98      0.98      1115

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>성공적으로 스팸메일을 분류하는데 성공했습니다. 모델을 저장하겠습니다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># sklearn 모델 저장</span>
<span class="kn">import</span> <span class="nn">joblib</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">'./models/'</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">'./models/'</span><span class="p">)</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="s1">'./models/naive_bayes.pkl'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['./models/naive_bayes.pkl']</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># sklearn 모델 불러오기</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">'./models/'</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">'./models/'</span><span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'./models/naive_bayes.pkl'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text_0</span> <span class="o">=</span> <span class="n">test_feature</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">label_0</span> <span class="o">=</span> <span class="n">test_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'text : '</span><span class="p">,</span> <span class="n">text_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'label : '</span><span class="p">,</span> <span class="n">label_0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>text :  Die... I accidentally deleted e msg i suppose 2 put in e sim archive. Haiz... I so sad...
label :  ham
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">text_0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array(['ham'], dtype='&lt;U4')</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text_1</span> <span class="o">=</span> <span class="n">test_feature</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">label_1</span> <span class="o">=</span> <span class="n">test_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'text : '</span><span class="p">,</span> <span class="n">text_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'label : '</span><span class="p">,</span> <span class="n">label_1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>text :  Welcome to UK-mobile-date this msg is FREE giving you free calling to 08719839835. Future mgs billed at 150p daily. To cancel send \go stop\" to 89123"
label :  spam
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">text_1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array(['spam'], dtype='&lt;U4')</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h3 id="4.-나이브-베이즈-알고리즘-장점">
<a class="anchor" href="#4.-%EB%82%98%EC%9D%B4%EB%B8%8C-%EB%B2%A0%EC%9D%B4%EC%A6%88-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98-%EC%9E%A5%EC%A0%90" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. 나이브 베이즈 알고리즘 장점<a class="anchor-link" href="#4.-%EB%82%98%EC%9D%B4%EB%B8%8C-%EB%B2%A0%EC%9D%B4%EC%A6%88-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98-%EC%9E%A5%EC%A0%90"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>나이브 베이즈 알고리즘은 단순하고 빠릅니다.</strong> 나이브 베이즈 알고리즘은 각 데이터들의 연관 관계를 고려하지 않습니다. 독립된 상황에서만 생각하기 때문에 사전 조건이 간단해지므로 결과를 도출하기까지 단순해지고 빠릅니다. 그래서 많은 데이터를 사용할 때 효과적으로 결과를 도출할 수 있습니다. 그렇다면 어떤 데이터들에게 적용시키는 것이 유리할까요? 서로 독립이라고 가정을 하기 때문에 기존 데이터들이 연속적이기보다는 이산적일 때 성능이 좋습니다. (실습때 속도가 느린건 다른 예제에 비해 처리할 데이터가 많아서입니다.)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<h3 id="5.-나이브-베이즈-알고리즘-단점">
<a class="anchor" href="#5.-%EB%82%98%EC%9D%B4%EB%B8%8C-%EB%B2%A0%EC%9D%B4%EC%A6%88-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98-%EB%8B%A8%EC%A0%90" aria-hidden="true"><span class="octicon octicon-link"></span></a>5. 나이브 베이즈 알고리즘 단점<a class="anchor-link" href="#5.-%EB%82%98%EC%9D%B4%EB%B8%8C-%EB%B2%A0%EC%9D%B4%EC%A6%88-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98-%EB%8B%A8%EC%A0%90"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>데이터간의 독립성이 없다면 부정확한 결과가 도출될 수 있습니다. 하나의 데이터가 다른 데이터에 영향이 없는 독립된 상황에서의 사용이 바람직합니다. 한정된 상황에서의 사용과 그로 인한 정확성의 불안정성이 나이브 베이즈 알고리즘의 대표적인 단점으로 볼 수 있습니다.</p>

</div>
</div>
</div>
</div>





    <br><br>
    <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = “https://gusdnd852.github.io/naive_bayes“;
this.page.identifier = 04. 나이브 베이즈 알고리즘;
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://gusdnd852.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<a class="u-url" href="/bigdata-lecture/naive_bayes" hidden></a>
</article>

<script>
	function run_exec(){
		if("colab" === "binder"){
			if(confirm("이 노트북은 CPU환경인 Binder에서 소스코드를 실행합니다.")){
				var binder_path = "https://mybinder.org/v2/gh/gusdnd852/bigdata-lecture/master?filepath=_notebooks%2F04_04_%EB%82%98%EC%9D%B4%EB%B8%8C_%EB%B2%A0%EC%9D%B4%EC%A6%88.ipynb";
				alert("Binder는 Docker기반의 컨테이너를 직접 빌드하기 때문에 시간이 다소 소요됩니다. Build logs의 show버튼을 눌러서 진행상황을 확인하세요");
				window.open(binder_path, "_blank");
							
			}
			
		}else if("colab" === "colab"){
			if(confirm("이 노트북은 GPU환경인 Google Colab에서 소스코드를 실행합니다.")){
				var colab_path = "https://colab.research.google.com/github/gusdnd852/bigdata-lecture/blob/master/_notebooks/04_04_나이브_베이즈.ipynb";
				alert("GPU 설정을 위해 Colab 상단 메뉴중, 런타임 → 런타임 유형변경에서 GPU를 선택해주세요. (미선택시 CPU에서 실행됨)");
				window.open(colab_path, "_blank");
			}			
		}else{
			alert("해당 실행환경은 구동이 불가능합니다. Binder와 Google Colab 중 한가지를 선택해주세요.");
		}
	}

    function code_listener() {
	var input_area = document.getElementsByClassName("input_area");

	for(var i = 0 ; i < input_area.length; i++){
		input_area[i].onclick = function(){
			run_exec();
    		}
	}

    } 

    code_listener();
</script>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/bigdata-lecture/"></data>

  <div class="wrapper">
      <div class="footer-col">
	<footer-elem class=px-2>
		<a href="https://github.com/gusdnd852">
			<svg class="social svg-icon">
				<use xlink:href="/bigdata-lecture/assets/minima-social-icons.svg#github"></use>
			</svg>
			<span class="username">Github</span>
		</a>
	</footer-elem>

	<footer-elem class=px-2>
		<a href="https://youtube.com/channel/UCb7DJAuj1LulbY8WEr2EDUw">
			<svg class="social svg-icon">
				<use xlink:href="/bigdata-lecture/assets/minima-social-icons.svg#youtube"></use>
			</svg>
			<span class="username">Youtube</span>
		</a>
	</footer-elem>

	<footer-elem class=px-2>
		<a href="https://www.facebook.com/gusdnd852">
			<svg class="social svg-icon">
				<use xlink:href="/bigdata-lecture/assets/minima-social-icons.svg#facebook"></use>
			</svg>
			<span class="username">Facebook</span>
		</a>
	</footer-elem>
	<br>
	<div class="copyright">
		© Copyright 2020 Hyunwoong Go. All rights reserved.
	</div>
      </div>
  </div>
</footer>
</body>
</html>
